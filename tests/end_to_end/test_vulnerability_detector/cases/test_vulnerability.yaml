---
- case: Installation of a vulnerable package
  id: install_package
  description: |
    Installation of a vulnerable package
  preconditions: null
  body:
    operation: install_package
    package:
      centos:
        amd64: grafana-8.5.5-1
        arm64v8: grafana-8.5.5-1
      ubuntu:
        amd64: grafana-8.5.5
        arm64v8: grafana-8.5.5
      windows:
        amd64: node-v17.0.1
      macos:
        amd64: http-proxy-0.5.9
        arm64v8: http-proxy-0.5.9

- case: Remove vulnerable package
  id: remove_package
  description: |
    Removal of a vulnerable package
  body:
    operation: remove_package
    package:
      centos:
        amd64: grafana-8.5.5-1
        arm64v8: grafana-8.5.5-1
      ubuntu:
        amd64: grafana-8.5.5
        arm64v8: grafana-8.5.5
      windows:
        amd64: node-v17.0.1
      macos:
        amd64: http-proxy-0.5.9
        arm64v8: http-proxy-0.5.9

- case: 'Upgrade: Maintain Vulnerability'
  id: upgrade_package_maintain_vulnerability
  description: |
    Upgrade of a vulnerable package which maintain vulnerability
  preconditions:
    operation: install_package
    target_os: ['centos', 'ubuntu', 'windows', 'macos']
    package:
      centos:
        amd64: grafana-8.5.5-1
        arm64v8: grafana-8.5.5-1
      ubuntu:
        amd64: grafana-8.5.5
        arm64v8: grafana-8.5.5
      windows:
        amd64: node-v17.0.1
      macos:
        amd64: http-proxy-0.5.9
        arm64v8: http-proxy-0.5.9
  body:
    operation: update_package
    package:
      from:
        centos:
          amd64: grafana-8.5.5-1
          arm64v8: grafana-8.5.5-1
        ubuntu:
          amd64: grafana-8.5.5
          arm64v8: grafana-8.5.5
        windows:
          amd64: node-v17.0.1
        macos:
          amd64: http-proxy-0.5.9
          arm64v8: http-proxy-0.5.9
      to:
        centos:
          amd64: grafana-8.5.6-1
          arm64v8: grafana-8.5.6-1
        ubuntu:
          amd64: grafana-8.5.6
          arm64v8: grafana-8.5.6
        windows:
          amd64: node-v17.1.0
        macos:
          amd64: http-proxy-0.5.10
          arm64v8: http-proxy-0.5.10

- case: 'Upgrade: New vulnerability '
  id: upgrade_package_add_vulnerability
  description: |
    Upgrade of a vulnerable package which include a new vulnerability
  preconditions:
    target_os: ['macos']
    operation: install_package
    package:
      macos:
        amd64: axios-0.6.0
        arm64v8: axios-0.6.0
  body:
    operation: update_package
    package:
      from:
        centos:
          amd64: grafana-8.5.6-1
          arm64v8: grafana-8.5.6-1
        ubuntu:
          amd64: grafana-8.5.6
          arm64v8: grafana-8.5.6
        windows:
          amd64: node-v17.1.0
        macos:
          amd64: axios-0.6.0
          arm64v8: axios-0.6.0
      to:
        centos:
          amd64: grafana-9.1.1-1
          arm64v8: grafana-9.1.1-1
        ubuntu:
          amd64: grafana-9.1.1
          arm64v8: grafana-9.1.1
        windows:
          amd64: node-v18.0.0
        macos:
          amd64: axios-0.10.0
          arm64v8: axios-0.10.0

- case: 'Upgrade: Maintain and new vulnerability '
  id: upgrade_package_maintain_add_vulnerability
  description: >
    Upgrade of a vulnerable package which maintain vulnerabilities
    and include new ones
  preconditions:
    target_os: ["macos"]
    operation: install_package
    package:
      macos:
        amd64: systeminformation-4.34.23
        arm64v8: systeminformation-4.34.23
  body:
    operation: update_package
    package:
      from:
        centos:
          amd64: grafana-9.1.1-1
          arm64v8: grafana-9.1.1-1
        ubuntu:
          amd64: grafana-9.1.1
          arm64v8: grafana-9.1.1
        windows:
          amd64: node-v18.0.0
        macos:
          amd64: systeminformation-4.34.23
          arm64v8: systeminformation-4.34.23
      to:
        centos:
          amd64: grafana-9.2.0-1
          arm64v8: grafana-9.2.0-1
        ubuntu:
          amd64: grafana-9.2.0
          arm64v8: grafana-9.2.0
        windows:
          amd64: node-v18.1.0
        macos:
          amd64: systeminformation-5.0.0
          arm64v8: systeminformation-5.0.0

- case: 'Upgrade: Cease vulnerability'
  id: upgrade_package_remove_vulnerability
  description: |
    Upgrade of a vulnerable which cease to be vulnerable
  body:
    operation: update_package
    package:
      from:
        centos:
          amd64: grafana-9.2.0-1
          arm64v8: grafana-9.2.0-1
        ubuntu:
          amd64: grafana-9.2.0
          arm64v8: grafana-9.2.0
        windows:
          amd64: node-v18.1.0
        macos:
          amd64: http-proxy-0.5.10
          arm64v8: http-proxy-0.5.10
      to:
        centos:
          amd64: grafana-9.4.17-1
          arm64v8: grafana-9.4.17-1
        ubuntu:
          arm64v8: grafana-9.4.17
          amd64: grafana-9.4.17
        windows:
          amd64: node-v18.20.0
        macos:
          amd64: http-proxy-0.7.0
          arm64v8: http-proxy-0.7.0

- case: 'Upgrade: Non vulnerable to non vulnerable'
  id: upgrade_package_nonvulnerable_to_nonvulnerable
  description: |
    Upgrade of a non vulnerable package to non vulnerable
  body:
    operation: update_package
    package:
      from:
        centos:
          amd64: grafana-9.4.17-1
          arm64v8: grafana-9.4.17-1
        ubuntu:
          arm64v8: grafana-9.4.17
          amd64: grafana-9.4.17
        windows:
          amd64: node-v18.20.0
        macos:
          amd64: http-proxy-0.7.0
          arm64v8: http-proxy-0.7.0
      to:
        centos:
          amd64: grafana-9.5.13-1
          arm64v8: grafana-9.5.13-1
        ubuntu:
          amd64: grafana-9.5.13
          arm64v8: grafana-9.5.13
        windows:
          amd64: node-v18.20.2
        macos:
          amd64: http-proxy-0.7.2
          arm64v8: http-proxy-0.7.2
  teardown:
    target_os: ['centos', 'ubuntu']
    operation: remove_package
    package:
      centos:
        amd64: grafana-9.5.13-1
        arm64v8: grafana-9.5.13-1
      ubuntu:
        amd64: grafana-9.5.13
        arm64v8: grafana-9.5.13

- case: 'Upgrade: Non vulnerable to vulnerable package'
  id: upgrade_package_nonvulnerable_to_vulnerable
  description: |
    Upgrade to non vulnerable package to vulnerable
  preconditions:
    target_os: ['centos', 'ubuntu', 'macos']
    operation: install_package
    package:
      macos:
        amd64: luxon-2.5.2
        arm64v8: luxon-2.5.2
      centos:
        amd64: grafana-9.3.16
        arm64v8: grafana-9.3.16
      ubuntu:
        amd64: grafana-9.3.16
        arm64v8: grafana-9.3.16
  body:
    operation: update_package
    package:
      from:
        centos:
          amd64: grafana-9.3.16
          arm64v8: grafana-9.3.16
        ubuntu:
          amd64: grafana-9.3.16
          arm64v8: grafana-9.3.16
        windows:
          amd64: node-v18.20.2
        macos:
          amd64: luxon-2.5.2
          arm64v8: luxon-2.5.2
      to:
        centos:
          amd64: grafana-9.4.1
          arm64v8: grafana-9.4.1
        ubuntu:
          amd64: grafana-9.4.1
          arm64v8: grafana-9.4.1
        windows:
          amd64: node-v20.5.1
        macos:
          amd64: luxon-3.0.0
          arm64v8: luxon-3.0.0
  teardown:
    operation: remove_package
    target_os: ['centos', 'ubuntu', 'macos', 'windows']
    package:
      centos:
        amd64: grafana-9.4.1
        arm64v8: grafana-9.4.1
      ubuntu:
        amd64: grafana-9.4.1
        arm64v8: grafana-9.4.1
      windows:
        amd64: node-v20.5.1
      macos:
        amd64: luxon-3.0.0
        arm64v8: luxon-3.0.0

- case: Installation of a non vulnerable package
  id: install_package_non_vulnerable
  description: |
    Installation of a non vulnerable package
  body:
    operation: install_package
    package:
      centos:
        amd64: grafana-9.5.17-1
        arm64v8: grafana-9.5.17-1
      ubuntu:
        amd64: grafana-9.5.17
        arm64v8: grafana-9.5.17
      windows:
        amd64: node-v18.20.0
      macos:
        amd64: http-proxy-0.7.0
        arm64v8: http-proxy-0.7.0

- case: 'Remove: Non vulnerable package'
  id: remove_non_vulnerable_packge
  description: |
    Removal of a non vulnerable package
  body:
    operation: remove_package
    package:
      centos:
        amd64: grafana-9.5.17-1
        arm64v8: grafana-9.5.17-1
      ubuntu:
        amd64: grafana-9.5.17
        arm64v8: grafana-9.5.17
      windows:
        amd64: node-v18.20.0
      macos:
        amd64: http-proxy-0.7.0
        arm64v8: http-proxy-0.7.0
