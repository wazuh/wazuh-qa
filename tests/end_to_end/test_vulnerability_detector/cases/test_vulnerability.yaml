- case: Installation of a vulnerable package
  id: install_package
  description: |
    Installation of a vulnerable package
      macos: 
        Used Packages: Node 17.0.1 - PKG Format
        CVES:
          amd64: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
          arm64v8: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      windows:
        Used Packages: Node 17.0.1 - Exe Format 
        CVE: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      ubuntu:
        Used Packages: Grafana 8.5.5 - .deb Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"],
      centos:
        Used Packages: Grafana 8.5.5 - .rpm Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"],
  preconditions: null
  body:
    tasks:
      agent:
        - operation: install_package
          package:
            centos:
              amd64: grafana-8.5.5-1
              arm64v8: grafana-8.5.5-1
            ubuntu:
              amd64: grafana-8.5.5
              arm64v8: grafana-8.5.5
            windows:
              amd64: node-v17.0.1
            macos:
              amd64: node-v17.0.1
              arm64v8: node-v17.0.1

- case: Remove vulnerable package
  id: remove_package
  description: |
    Removal of a vulnerable package
      macos: 
          Used Package: Node 17.0.1 - PKG Format
          CVES Expected to mitigate:
            ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      windows:
        Used Package: Node 17.0.1 - Exe Format 

        CVES Expected to mitigate: 
          ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      ubuntu:
        Used Package Mysql 5.5.20 - .deb Format
        CVES Expected to mitigate:
          ["CVE-2023-22028", "CVE-2023-22026", "CVE-2023-22015", "CVE-2023-22007", "CVE-2023-21980", "CVE-2023-21977", "CVE-2022-21444", "CVE-2022-21417", "CVE-2021-22570", "CVE-2021-2356", "CVE-2020-15358", "CVE-2020-14852", "CVE-2020-14846", "CVE-2020-14845", "CVE-2020-14839", "CVE-2020-14837", "CVE-2020-14830"]
      centos:
        Used Package Openjdk 1.6.0 - .rpm Format
        CVE Expected to mitigate:
          ["CVE-2023-21967", "CVE-2023-21954", "CVE-2023-21939", "CVE-2023-21938", "CVE-2023-21937", "CVE-2023-21930", "CVE-2014-2405", "CVE-2014-1876", "CVE-2014-0462", "CVE-2012-5373", "CVE-2012-2739"]
  preconditions: null
  body:
    tasks:
      - operation: remove_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: openjdk-1.6.0
          ubuntu:
            amd64: mysql-5.5.20
          windows:
            amd64: node-v17.0.1
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
- case: 'Upgrade: Maintain Vulnerability'
  id: upgrade_package_maintain_vulnerability
  description: |
    Upgrade of a vulnerable package which maintain vulnerability
    macos: 
        Used Package: Node 17.1.0 - PKG Format
        CVES:
          amd64: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
          arm64v8: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
    windows:
      Used Package: Node 17.1.0 - Exe Format 
      "CVE": ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
    ubuntu:
      Used Package Mysql 5.5.21 - .deb Format
      CVE: ["CVE-2023-22028", "CVE-2023-22026", "CVE-2023-22015", "CVE-2023-22007", "CVE-2023-21980", "CVE-2023-21977", "CVE-2022-21444", "CVE-2022-21417", "CVE-2021-22570", "CVE-2021-2356", "CVE-2020-15358", "CVE-2020-14852", "CVE-2020-14846", "CVE-2020-14845", "CVE-2020-14839", "CVE-2020-14837", "CVE-2020-14830"]
    centos:
      Used Package Openjdk 1.7.0 - .rpm Format
      CVE: ["CVE-2023-21967", "CVE-2023-21954", "CVE-2023-21939", "CVE-2023-21938", "CVE-2023-21937", "CVE-2023-21930", "CVE-2014-8873", "CVE-2014-2483", "CVE-2014-1876", "CVE-2013-2461", "CVE-2012-5373", "CVE-2012-2739"]
  preconditions:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: openjdk-1.6.0
          ubuntu:
            amd64: mysql-5.5.20
          windows:
            amd64: node-v17.0.1
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: openjdk-1.6.0
            ubuntu:
              amd64: mysql-5.5.20
            windows:
              amd64: node-v17.0.1
            macos:
              amd64: node-v17.0.1
              arm64v8: node-v17.0.1
          to:
            centos:
              amd64: openjdk-1.7.0
            ubuntu:
              amd64: mysql-5.5.21
            windows:
              amd64: node-v17.1.0
            macos:
              amd64: node-v17.1.0
              arm64v8: node-v17.1.0

- case: 'Upgrade: New vulnerability '
  id: upgrade_package_maintain_add_vulnerability
  description: |
    Upgrade of a vulnerable package which include a new vulnerability
    macos: 
        Used Package: Node 18.11.0 - PKG Format
        CVES:  ["CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32006", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30585", "CVE-2023-30581", "CVE-2023-23920", "CVE-2023-23919", "CVE-2023-23918", "CVE-2022-32222"],
    windows:
      Used Package: Node 18.0.0 - Exe Format 
      "CVE": ["CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32006", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30589", "CVE-2023-30588", "CVE-2023-30585", "CVE-2023-30581", "CVE-2023-23920", "CVE-2023-23919", "CVE-2023-23918", "CVE-2022-43548", "CVE-2022-35256", "CVE-2022-35255", "CVE-2022-32223", "CVE-2022-32222", "CVE-2022-32215", "CVE-2022-32214", "CVE-2022-32213", "CVE-2022-32212", "CVE-2022-3786", "CVE-2022-3602"],
    ubuntu:
      Used Package Mysql 5.5.19 - .deb Format
      CVE: ["CVE-2023-22026", "CVE-2023-22015", "CVE-2023-22007", "CVE-2023-21980", "CVE-2023-21977", "CVE-2022-21444", "CVE-2022-21417", "CVE-2021-22570", "CVE-2023-22007", "CVE-2023-22028", "CVE-2021-2356", "CVE-2022-21417", "CVE-2022-21444", "CVE-2023-21980", "CVE-2023-21977"]
    centos:
      Used Package Openjdk 1.7.0 - .rpm Format
      CVE: ["CVE-2023-21967", "CVE-2023-21954", "CVE-2023-21939", "CVE-2023-21938", "CVE-2023-21937", "CVE-2023-21930", "CVE-2014-8873", "CVE-2014-2483", "CVE-2014-1876", "CVE-2013-2461", "CVE-2012-5373", "CVE-2012-2739"]
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: openjdk-1.6.0
            ubuntu:
              amd64: mysql-5.5.18
            windows:
              amd64: node-v17.1.0
            macos:
              amd64: node-v17.1.0
              arm64v8: node-v17.1.0
          to:
            centos:
              amd64: openjdk-1.7.0
            ubuntu:
              amd64: mysql-5.5.19
            windows:
              amd64: node-v18.0.0
            macos:
              amd64: node-v18.11.0
              arm64v8: node-v18.11.0
    
- case: 'Upgrade: Maintain and new vulnerability '
  id: upgrade_package_maintain_add_vulnerability
  description: >
    Upgrade of a vulnerable package which maintain vulnerabilities and include
    new ones

    macos: 
        Used Package: Node 18.12.0 - PKG Format
        "CVE": ["CVE-2023-44487", "CVE-2023-38552", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30585", "CVE-2023-23936", "CVE-2023-23920", "CVE-2023-23919", "CVE-2023-23918", "CVE-2022-43548", "CVE-2022-3786", "CVE-2022-3602"],
    windows:
      Used Package: Node 18.1.0 - Exe Format 
      "CVE": ["CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32006", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30585", "CVE-2023-30581", "CVE-2023-23920", "CVE-2023-23919", "CVE-2023-23918", "CVE-2022-43548", "CVE-2022-35256", "CVE-2022-35255", "CVE-2022-32222", "CVE-2022-32215", "CVE-2022-32214", "CVE-2022-32213", "CVE-2022-32212", "CVE-2022-3786", "CVE-2022-3602"],
    ubuntu:
      Used Package Mysql 5.5.19 - .deb Format
      CVE: ["CVE-2023-22026", "CVE-2023-22015", "CVE-2023-22007", "CVE-2023-21980", "CVE-2023-21977", "CVE-2022-21444", "CVE-2022-21417", "CVE-2021-22570", "CVE-2023-22007", "CVE-2023-22028", "CVE-2021-2356", "CVE-2022-21417", "CVE-2022-21444", "CVE-2023-21980", "CVE-2023-21977"]
    centos:
      Used Package Openjdk 1.8.0 - .rpm Format
      CVE: ["CVE-2023-21967", "CVE-2023-21954", "CVE-2023-21939", "CVE-2023-21938", "CVE-2023-21937", "CVE-2023-21930", "CVE-2021-20264", "CVE-2014-1876", "CVE-2012-2739"]
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: openjdk-1.7.0
            ubuntu:
              amd64: mysql-5.5.18
            windows:
              amd64: node-v18.0.0
            macos:
              amd64: node-v18.11.0
              arm64v8: node-v18.11.0
          to:
            centos:
              amd64: openjdk-1.8.0
            ubuntu:
              amd64: mysql-5.5.19
            windows:
              amd64: node-v18.1.0
            macos:
              amd64: node-v18.12.0
              arm64v8: node-v18.12.0
    
- case: 'Upgrade: Cease vulnerability'
  id: upgrade_package_remove_vulnerability
  description: |
    Upgrade of a vulnerable which cease to be vulnerable
    macos: 
        Used Package: Node 19.5.0 - PKG Format
        "CVE": [],
    windows:
      Used Package: Node 19.5.0 - Exe Format 
      "CVE": [],
    ubuntu:
      Used Package Grafana 9.4.17 - .deb Format
      CVE: []
    centos:
      Used Package Grafana 9.4.17 - .rpm Format
      CVE: []
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-9.2.0
              arm64v8: grafana-9.2.0
            ubuntu:
              amd64: grafana-9.2.0
              arm64v8: grafana-9.2.0
            windows:
              amd64: node-v18.1.0
            macos:
              amd64: node-v18.12.0
              arm64v8: node-v18.12.0
          to:
            centos:
              amd64: grafana-9.4.17
              arm64v8: grafana-9.4.17
            ubuntu:
              arm64v8: grafana-9.4.17
              amd64: grafana-9.4.17
            windows:
              amd64: node-v19.5.0
            macos:
              amd64: node-v19.5.0
              arm64v8: node-v19.5.0
    
- case: 'Upgrade: Non vulnerable to non vulnerable'
  id: upgrade_package_nonvulnerable_to_nonvulnerable
  description: |
    Upgrade of a non vulnerable package to non vulnerable
      macos: 
          Used Package: Node 19.5.0 - PKG Format
          "CVE": [],
      windows:
        Used Package: Node 19.5.0 - Exe Format 
        "CVE": [],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: []
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: []
  preconditions:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          windows:
            amd64: node-v19.5.0
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: grafana-9.4.17
              arm64v8: grafana-9.4.17
            ubuntu:
              arm64v8: grafana-9.4.17
              amd64: grafana-9.4.17
            windows:
              amd64: node-v19.5.0
            macos:
              amd64: node-v19.5.0
              arm64v8: node-v19.5.0
          to:
            centos:
              amd64: grafana-9.5.13
              arm64v8: grafana-9.5.13
            ubuntu:
              amd64: grafana-9.5.13
              arm64v8: grafana-9.5.13
            windows:
              amd64: node-v19.6.0
            macos:
              amd64: node-v19.6.0
              arm64v8: node-v19.6.0
    
- case: 'Upgrade: Non vulnerable to vulnerable package'
  id: upgrade_package_nonvulnerable_to_vulnerable
  description: |
    Upgrade to non vulnerable package to vulnerable
      macos: 
          Used Package: Node 20.0.0 - PKG Format
          "CVE": ["CVE-2023-44487", "CVE-2023-39332", "CVE-2023-39331", "CVE-2023-38552", "CVE-2023-32559", "CVE-2023-32558", "CVE-2023-32006", "CVE-2023-32005", "CVE-2023-32004", "CVE-2023-32003", "CVE-2023-32002", "CVE-2023-30590", "CVE-2023-30588", "CVE-2023-30586", "CVE-2023-30585", "CVE-2023-30581"],
      windows:
        Used Package: Node 20.5.1 - Exe Format 
        "CVE": ["CVE-2023-44487", "CVE-2023-39332", "CVE-2023-39331", "CVE-2023-38552"],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: ["CVE-2023-4822", "CVE-2023-4399"],
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: ["CVE-2023-4822", "CVE-2023-4399"],
  preconditions: null
  body:
    tasks:
      - operation: update_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          from:
            centos:
              amd64: firefox-91.13.0
              arm64v8: grafana-8.5.5
            ubuntu:
              amd64: grafana-8.5.5
            windows:
              amd64: node-v19.6.0
            macos:
              amd64: node-v19.6.0
              arm64v8: node-v19.6.0
          to:
            centos:
              amd64: firefox-91.13.0
              arm64v8: grafana-8.5.5
            ubuntu:
              amd64: grafana-8.5.5
            windows:
              amd64: node-v20.5.1
            macos:
              amd64: node-v20.0.0
              arm64v8: node-v20.0.0
    
- case: Installation of a non vulnerable package
  id: install_package_non_vulnerable
  description: |
    Installation of a non vulnerable package
      macos: 
          Used Package: Node 19.5.0 - PKG Format
          "CVE": [],
      windows:
        Used Package: Node 19.5.0 - Exe Format 
        "CVE": [],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: []
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: []
  preconditions: null
  body:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          ubuntu:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          windows:
            amd64: node-v19.5.0
          macos:
            amd64: node-v19.6.0
            arm64v8: node-v19.6.0
- case: 'Remove: Non vulnerable package'
  id: remove_non_vulnerable_packge
  description: |
    Removal of a non vulnerable package
      macos: 
          Used Package: Node 19.5.0 - PKG Format
          "CVE": [],
      windows:
        Used Package: Node 19.5.0 - Exe Format 
        "CVE": [],
      ubuntu:
        Used Package Grafana 9.5.13 - .deb Format
        CVE: []
      centos:
        Used Package Grafana 9.5.13 - .rpm Format
        CVE: []
  body:
    tasks:
      - operation: remove_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          ubuntu:
            amd64: grafana-9.5.13
            arm64v8: grafana-9.5.13
          windows:
            amd64: node-v19.5.0
          macos:
            amd64: node-v19.6.0
            arm64v8: node-v19.6.0
    

