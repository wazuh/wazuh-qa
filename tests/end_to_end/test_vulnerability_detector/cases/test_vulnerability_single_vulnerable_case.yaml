- case: Installation of a vulnerable package
  id: install_package
  description: |
    Installation of a vulnerable package
      macos:
        Used Packages: Node 17.0.1 - PKG Format
        CVES:
          amd64: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
          arm64v8: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      windows:
        Used Packages: Node 17.0.1 - Exe Format
        CVE: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      ubuntu:
        Used Packages: Grafana 8.5.5 - .deb Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"],
      centos:
        Used Packages: Grafana 8.5.5 - .rpm Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"],
  preconditions: null
  body:
    tasks:
      - agent:
          operation: install_package
          package:
            centos:
              amd64: grafana-8.5.5-1
              arm64v8: grafana-8.5.5-1
            ubuntu:
              amd64: grafana-8.5.5
              arm64v8: grafana-8.5.5
            windows:
              amd64: node-v17.0.1
            macos:
              amd64: node-v17.0.1
              arm64v8: node-v17.0.1
  teardown:
    tasks:
      - agent:
        operation: remove_package
        package:
          centos:
            amd64: grafana-8.5.5-1
            arm64v8: grafana-8.5.5-1
          ubuntu:
            amd64: grafana-8.5.5
            arm64v8: grafana-8.5.5
          windows:
            amd64: node-v17.0.1
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
