- case: Installation of a vulnerable package
  id: install_package_change_manager
  description: |
    Installation of a vulnerable package
      macos:
      Used Package: Node 17.0.1 - PKG Format
      CVES:
        amd64: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
        arm64v8: ["CVE-2022-21824", "CVE-2022-0778", "CVE-2021-44533", "CVE-2021-44532", "CVE-2021-44531", "CVE-2021-4044"],
      windows:
        Used Package: VLC 3.0.6 - Exe Format
        CVE: ["CVE-2023-47360", "CVE-2023-47359", "CVE-2023-46814", "CVE-2022-41325", "CVE-2020-26664", "CVE-2019-19721", "CVE-2019-13962", "CVE-2019-13602", "CVE-2019-12874", "CVE-2019-5460", "CVE-2019-5459", "CVE-2019-5439"],
      ubuntu:
        Used Package Grafana 8.5.5 - .deb Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
      centos:
        Used Package Grafana - .rpm Format
        CVE: ["CVE-2023-2183", "CVE-2023-1410", "CVE-2023-0594", "CVE-2023-0507", "CVE-2022-39324", "CVE-2022-39307", "CVE-2022-39306", "CVE-2022-39229", "CVE-2022-39201", "CVE-2022-36062", "CVE-2022-35957", "CVE-2022-31130", "CVE-2022-31123", "CVE-2022-31107", "CVE-2022-31097", "CVE-2022-23552", "CVE-2022-23498"]
  preconditions: null
  body:
    tasks:
      - operation: install_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: openjdk-1.6.0
          ubuntu:
            amd64: mysql-5.5.20
          windows:
            amd64: node-v17.0.1
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
  teardown:
    tasks:
      - operation: remove_package
        target: agent
        check:
          alerts: true
          state_index: true
        package:
          centos:
            amd64: openjdk-1.6.0
            arm64v8: openjdk-1.6.0
          ubuntu:
            amd64: mysql-5.5.20
            arm64v8: mysql-5.5.20
          windows:
            amd64: node-v17.0.1
          macos:
            amd64: node-v17.0.1
            arm64v8: node-v17.0.1
