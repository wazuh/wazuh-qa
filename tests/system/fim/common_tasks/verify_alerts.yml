---

  - name: "Verify alert json log | {{ event }}"
    script: >
      verify_alerts_json.py 
      -i "{{ agents_results_manager_path }}/{{ event }}/files_{{ event }}.txt-{{ item }}" 
      -e {{ event }}
      -o "{{ missing_alerts_json_path }}-{{ event }}-{{ item }}" 
      {{ json_verification_extra_arguments }}
    args:
      executable: "python3"
    when:
      - inventory_hostname in groups['masters']
    with_items:
      - "{{ groups['linuxagents'] + groups['windowsagents'] }}"
    

  - name: "Verify elastic alerts | {{ event }}"
    script: >
      verify_alerts_elasticsearch.py 
      -i "{{ agents_results_manager_path }}/{{ event }}/files_{{ event }}.txt-{{ item }}" 
      -e {{ event }}
      -a {{ hostvars[groups["elasticsearch"][0]]["private_ip"] }}
      -o "{{ missing_alerts_elasticsearch_path }}-{{ event }}-{{ item }}"
      {{ elastic_verification_extra_arguments }}
    args:
      executable: python3
    when:
      - inventory_hostname in groups['masters']
    with_items:
      - "{{ groups['linuxagents'] + groups['windowsagents'] }}"