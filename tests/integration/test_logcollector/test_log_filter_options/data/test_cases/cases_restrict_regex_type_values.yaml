- name: Test Restrict tag - PCRE2 engine - log matches
  description: Test Restrict with PCRE2 regex, with matching log
  configuration_parameters:
    REGEX: .*test
    REGEX_TYPE: PCRE2
  metadata:
    regex: .*test
    regex_type: PCRE2
    log_sample: "Nov 10 12:19:04 localhost sshd: log matches test"
    matches: true

- name: Test Restrict tag - PCRE2 engine - log does not match
  description: Test Restrict with PCRE2 regex, with not matching log
  configuration_parameters:
    REGEX: .*test
    REGEX_TYPE: PCRE2
  metadata:
    regex: .*test
    regex_type: PCRE2
    log_sample: "Nov 10 12:19:04 localhost sshd: log does not match"
    matches: false

- name: Test Restrict tag - osmatch engine - log match
  description: Test Restrict with osmatch regex, with matching log
  configuration_parameters:
    REGEX: test$
    REGEX_TYPE: osmatch
  metadata:
    regex: test\$
    regex_type: osmatch
    log_sample: "Nov 10 12:19:04 localhost sshd: log matches test"
    matches: true

- name: Test Restrict tag - osmatch engine - log does not match
  description: Test Restrict with osmatch regex, with not matching log
  configuration_parameters:
    REGEX: test$
    REGEX_TYPE: osmatch
  metadata:
    regex: test\$
    regex_type: osmatch
    log_sample: "Nov 10 12:19:04 localhost sshd: log does not match"
    matches: false

- name: Test Restrict tag - osregex engine - log match
  description: Test Restrict with osregex regex, with matching log
  configuration_parameters:
    REGEX: \.test
    REGEX_TYPE: osregex
  metadata:
    regex: \\.test
    regex_type: osregex
    log_sample: "Nov 10 12:19:04 localhost sshd: log matches test"
    matches: true

- name: Test Restrict tag - osregex engine - log does not match
  description: Test Restrict with osregex regex, with not matching log
  configuration_parameters:
    REGEX: \.test
    REGEX_TYPE: osregex
  metadata:
    regex: \\.test
    regex_type: osregex
    log_sample: "Nov 10 12:19:04 localhost sshd: log does not match"
    matches: false
