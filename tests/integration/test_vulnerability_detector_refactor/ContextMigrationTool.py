import subprocess as sbp

class ContextMigrationTool():

    def __init__(self, args):
        self.working_dir = '/var/wazuh'
        self.executable = f"{self.working_dir}bin/context_migration"
        self.args = args


    def run(self):
        """Method to run the context migration tool with specified parameters and get the output.
        """

        popen = sbp.Popen(executable=self.executable , args=self.args, stdout=sbp.PIPE)
        # Wait for the binary to finish and return its
        return_code = popen.wait()

        if return_code == 0:
            output = popen.stdout.read()
        else:
            output = popen.stderr.read()

        yield output