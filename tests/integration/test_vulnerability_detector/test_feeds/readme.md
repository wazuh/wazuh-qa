# Test feeds

## Objective

The purpose of testing imported feeds is to check the behavior of the vulnerability detector when importing feeds that may have some kind of error.

## Expected behavior

The expected behavior is to **rule out** those vulnerabilities whose content is malformed making vulnerability detector **not fail** for any related reason.

## Testing

The tests can be classified into:

- **Generics**: Generic tests that are carried out on the feeds, regardless of the provider
- **Providers**: Specific tests of each provider in which the feed is altered and the result is evaluated.

### Generic tests

- `test_download_feeds`: Tests that are based on downloading the different feeds (redhat, canonical, debian and NVD) and looking for the message confirming that the feeds have been downloaded and imported correctly.

- `test_invalid_type_custom_feeds`: Tests that are based on importing files of several different types (`.mp3`, `.jpg`, `.pdf` ...) as custom feed, and observing the response of vulnerability detector.

- `test_validate_feed_content`: Tests that are based on downloading the feeds of all providers and verifying that the format of each feed is as expected and that the content of the feed is also `XML` or `JSON` parseable.

### Providers tests

#### Red Hat

- `test_extra_fields_redhat_feed`: Set of tests that are based on checking the behavior of vulnerability detector when there is any extra field in the feed.

- `test_invalid_syntax_redhat_feed`: Set of tests that are based on checking the behavior of vulnerability detector when the feed has some kind of syntactic error: it doesn't have a closing field, it's missing some character ...

- `test_invalid_values_redhat_feed`: Set of tests that are based on checking the behavior of vulnerability detector when the value of a field is not correct: invalid type, strange characters ...

- `test_missing_fields_canonical_feed`: Set of tests that are based on checking the behavior of vulnerability detector when any field is missing from the feed.

#### Canonical

- **[test_extra_tags_canonical_feed](../doc/test_feeds/canonical/test_extra_tags_canonical_feed.md)**:  Set of tests that are based on checking the behavior of vulnerability detector when there is any extra tag in the feed.

- `test_invalid_syntax_canonical_feed`: Set of tests that are based on checking the behavior of vulnerability detector when the feed has some kind of syntactic error: it doesn't have a closing tag, it's missing some character ...

- `test_invalid_values_canonical_feed`: Set of tests that are based on checking the behavior of vulnerability detector when the value of a field is not correct: invalid type, strange characters ...

- `test_missing_tags_canonical_feed`: Set of tests that are based on checking the behavior of vulnerability detector when any tag is missing from the feed.

#### Debian

- `test_extra_tags_debian_feed`: Set of tests that are based on checking the behavior of vulnerability detector when there is any extra tag in the feed.

- `test_invalid_syntax_debian_feed`: Set of tests that are based on checking the behavior of vulnerability detector when the feed has some kind of syntactic error: it doesn't have a closing tag, it's missing some character ...

- `test_invalid_values_debian_feed`: Set of tests that are based on checking the behavior of vulnerability detector when the value of a field is not correct: invalid type, strange characters ...

- `test_missing_tags_debian_feed`: Set of tests that are based on checking the behavior of vulnerability detector when any tag is missing from the feed.
