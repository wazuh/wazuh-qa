# Test feeds

## Objective

The purpose of testing imported feeds is to check the behavior of Vulnerability Detector when importing feeds that may
have some kind of error.

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 1-2 | 1134 | 2h 53m |

## Expected behavior

The expected behavior is to **discard** those vulnerabilities whose content is malformed making Vulnerability Detector
**not fail** for it.

## Testing

The tests can be classified into:

- **Generics**: tests that are carried out on the feeds, regardless of the provider.
- **Providers**: specific tests of each provider where the feed is modified and the result is evaluated.

### Generic tests

- **[test_download_feeds](../doc/test_feeds/generic/test_download_feeds.md#test-download-feeds)**: Tests that download
the different feeds (Redhat, Canonical, Debian, and NVD) and check the confirmation message saying the feeds have been
correctly downloaded and imported.

- **[test_invalid_type_custom_feeds](../doc/test_feeds/generic/test_invalid_type_custom_feeds.md#test-invalid-type-custom-feeds)**:
Tests that importing files of several different types (`.mp3`, `.jpg`, `.pdf` ...) as custom feed, and check the
response of Vulnerability Detector.

- **[test_validate_feed_content](../doc/test_feeds/generic/test_validate_feed_content.md#test-validate-feed-content)**:
Tests that download the feeds of all the providers and verify their format is as expected and their content is also
`XML` or `JSON` parseable.

### Providers tests

#### RedHat

- **[test_extra_fields_redhat_feed](../doc/test_feeds/redhat/test_extra_fields_redhat_feed.md#test-extra-fields-red-hat-feed)**:
Set of tests that check the behavior of Vulnerability Detector when there is any extra field in the feed.

- **[test_invalid_syntax_redhat_feed](../doc/test_feeds/redhat/test_invalid_syntax_redhat_feed.md#test-invalid-syntax-red-hat-feed)**:
Set of tests that check the behavior of Vulnerability Detector when the feed has syntactic errors.

- **[test_invalid_values_redhat_feed](../doc/test_feeds/redhat/test_invalid_values_redhat_feed.md#test-invalid-values-red-hat-feed)**:
Set of tests that check the behavior of Vulnerability Detector when the value of a field is not correct.

- **[test_missing_fields_redhat_feed](../doc/test_feeds/redhat/test_missing_fields_redhat_feed.md#test-missing-fields-red-hat-feed)**:
Set of tests that check the behavior of Vulnerability Detector when any field is missing from the feed.

#### Canonical

- **[test_extra_tags_canonical_feed](../doc/test_feeds/canonical/test_extra_tags_canonical_feed.md#test-extra-tags-canonical-feed)**:
Set of tests that check the behavior of Vulnerability Detector when there is any extra tag in the feed.

- **[test_invalid_syntax_canonical_feed](../doc/test_feeds/canonical/test_invalid_syntax_canonical_feed.md#test-invalid-syntax-canonical-feed)**:
Set of tests that check the behavior of Vulnerability Detector when the feed has some kind of syntactic error.

- **[test_invalid_values_canonical_feed](../doc/test_feeds/canonical/test_invalid_values_canonical_feed.md#test-invalid-values-canonical-feed)**:
Set of tests that check the behavior of Vulnerability Detector when the value of a tag is not correct.

- **[test_missing_tags_canonical_feed](../doc/test_feeds/canonical/test_missing_tags_canonical_feed.md#test-missing-tags-canonical-feed)**:
 Set of tests that check the behavior of Vulnerability Detector when any tag is missing from the feed.

#### Debian

- **[test_extra_tags_debian_feed](../doc/test_feeds/debian/test_extra_tags_debian_feed.md#test-extra-tags-debian-feed)**:
Set of tests that check the behavior of Vulnerability Detector when there is any extra tag in the feed.

- **[test_invalid_syntax_debian_feed](../doc/test_feeds/debian/test_invalid_syntax_debian_feed.md#test-invalid-syntax-debian-feed)**:
Set of tests that checking the behavior of Vulnerability Detector when the feed has some kind of syntactic error.

- **[test_invalid_values_debian_feed](../doc/test_feeds/debian/test_invalid_values_debian_feed.md#test-invalid-values-debian-feed)**:
Set of tests that check the behavior of Vulnerability Detector when the value of a tag is not correct.

- **[test_missing_tags_debian_feed](../doc/test_feeds/debian/test_missing_tags_debian_feed.md#test-missing-tags-debian-feed)**:
Set of tests that check the behavior of Vulnerability Detector when any tag is missing from the feed.
