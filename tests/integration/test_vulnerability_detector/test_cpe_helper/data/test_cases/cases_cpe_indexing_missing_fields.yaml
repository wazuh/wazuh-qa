- name: Missing version field
  description: Indexing CPE helper with missing version field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - VERSION_TAG
    expected_result: package_indexed
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing format_version field
  description: Indexing CPE helper with missing format_version field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - FORMAT_TAG
    expected_result: error_updating_cve_database
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing update_date field
  description: Indexing CPE helper with missing update_date field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - UPDATE_TAG
    expected_result: error_updating_cve_database
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing target field
  description: Indexing CPE helper with missing target field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - TARGET_TAG
    expected_result: package_not_indexed
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing action field
  description: Indexing CPE helper with missing action field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - ACTION_TAG
    expected_result: package_not_indexed
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing vendor field
  description: Indexing CPE helper with missing vendor field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - VENDOR_T_TAG
    expected_result: error_inserting_package
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing product field
  description: Indexing CPE helper with missing product field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - PRODUCT_T_TAG
    expected_result: error_inserting_package
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2

- name: Missing update field
  description: Indexing CPE helper with missing update field
  configuration_parameters:
    NVD_JSON_PATH: CUSTOM_NVD_JSON_PATH
  metadata:
    system: WINDOWS_10
    wrong_field: null
    missing_field:
      - UPDATE_T_TAG
    expected_result: package_indexed
    tags:
      VERSION_TAG: version
      FORMAT_TAG: format_version
      UPDATE_TAG: update_date
      DICTIONARY_TAG: dictionary
      TARGET_TAG: target
      SOURCE_TAG: source
      VENDOR_S_TAG: vendor
      PRODUCT_S_TAG: product
      VERSION_S_TAG: version
      UPDATE_S_TAG: update
      TRANSLATION_TAG: translation
      VENDOR_T_TAG: vendor
      PRODUCT_T_TAG: product
      VERSION_T_TAG: version
      UPDATE_T_TAG: update
      ACTION_TAG: action
      LICENSE_TAG: license
      TITLE_TAG: title
      COPYRIGHT_TAG: copyright
      DATE_TAG: date
      TYPE_TAG: type
    values:
      VERSION_VALUE: "1.0"
      FORMAT_VALUE: "1.0"
      UPDATE_VALUE: 2050-10-02T10:56Z
      TARGET_VALUE: windows
      VENDOR_S_VALUE: ^wazuh-mocking
      PRODUCT_S_VALUE_0: custom-package-0
      PRODUCT_S_VALUE_1: custom-package-1
      PRODUCT_S_VALUE_2: custom-package-2
      PRODUCT_S_VALUE_3: custom-package-3
      PRODUCT_S_VALUE_4: custom-package-4
      VERSION_S_VALUE: ""
      UPDATE_S_VALUE: ""
      VENDOR_T_VALUE: wazuh-mocking
      PRODUCT_T_VALUE_0: custom-package-0
      PRODUCT_T_VALUE_1: custom-package-1
      PRODUCT_T_VALUE_2: custom-package-2
      PRODUCT_T_VALUE_3: custom-package-3
      PRODUCT_T_VALUE_4: custom-package-4
      VERSION_T_VALUE: ""
      UPDATE_T_VALUE: ""
      ACTION_VALUE_0: replace_vendor
      ACTION_VALUE_1: replace_product
      ACTION_VALUE_2: set_update_if_product_matches
      TITLE_VALUE: Dictionary of CPEs to analyze system vulnerabilities.
      COPYRIGHT_VALUE: Copyright (C) 2015-2019, Wazuh Inc.
      DATE_VALUE: March 6, 2019.
      TYPE_VALUE: GPLv2
