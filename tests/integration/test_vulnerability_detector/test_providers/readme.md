# Test providers

## Objective

The purpose of testing providers' settings is to check that these options for the Vulnerability Detector module are
working as expected. These general options are:

- `<enabled>`
- `<os>`
- `<update_from_year>`
- `<update_interval>`

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 49 | 0:05:04 |

## Expected behavior

- `enabled`: If set to `yes`, the provider must be activated, otherwise will be deactivated.
- `os`: If it has a correct value, the feed of this `os` must be downloaded.
- `update_from_year`: Feeds newer than the year set must be downloaded.
- `update_interval`: Feeds have to be downloaded and updated each `<x>`time set.

## Testing

### Generic tests

- **[test_providers_enabled](../doc/test_providers/test_providers_enabled.md#test-providers-enabled)**: Tests that
modify the value of `enabled` tag in `ossec.conf` and checking the result in `ossec.log`.

- **[test_providers_os](../doc/test_providers/test_providers_os.md#test-providers-os)**: Tests that modify the value
of `os` tag in `ossec.conf`, set different os for Canonical and Debian and check the result in `ossec.log`.

- **[test_providers_update_from_year](../doc/test_providers/test_providers_update_from_year.md#test-providers-update-from-year)**:
Tests that modify the value of `update_from_year` tag in `ossec.conf`, set different years and check the result in
`ossec.log`.

- **[test_providers_update_interval](../doc/test_providers/test_providers_update_interval.md#test-providers-update-interval)**:
Tests that modify the value of `interval` tag in `ossec.conf`, set different time intervals and units, and check the
result in `ossec.log`.
