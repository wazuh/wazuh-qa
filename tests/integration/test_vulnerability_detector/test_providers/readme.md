# Test providers

## Objective

The purpose of testing providers settings is to check that the provider configurable options for vulnerability
detector module is working as expected. These general options are:

- `<enabled>`
- `<os>`
- `<update_from_year>`
- `<update_interval>`

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 49 | 0:05:04 |

## Expected behavior

- `enabled`: If `yes` the provider must be actived, otherwise will be deactivated.
- `os`: If it has a correct value, the feed of this `os` must be downloaded.
- `update_from_year`: Feeds greater than the year set must be downloaded.
- `update_interval`: Feeds have to be downloaded and updated each `<x>`time set.

## Testing

### Generic tests

- **[test_providers_enabled](../doc/test_providers/test_providers_enabled.md)**: Tests that are based on modifying the
value of `enabled` tag in `ossec.conf` and checking the result in `ossec.log`.

- **[test_providers_os](../doc/test_providers/test_providers_os.md)**: Tests that are based on modifying the value
of `os` tag in `ossec.conf`, setting different os for Canonical and Debian and checking the result in `ossec.log`.

- **[test_providers_update_from_year](../doc/test_providers/test_providers_update_from_year.md)**: Tests that are based
on modifying the value of `update_from_year` tag in `ossec.conf`, setting different years and checking the result in
`ossec.log`.

- **[test_providers_update_interval](../doc/test_providers/test_providers_update_interval.md)**: Tests that are based
on modifying the value of `interval` tag in `ossec.conf`, setting different time intervals and units, and checking the
result in `ossec.log`.
