# Test general settings

## Objective

The purpose of testing general settings is to check that the main configurable options for vulnerability detector module
is working as expected. These general options are:

- `<enabled>`
- `<ignore_time>`
- `<interval>`
- `<run_on_start>`

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 19 | 0:02:47  |

## Expected behavior

- `enabled`: If it set to `yes`, Vulnerability Detector must be started, otherwise will be stopped.
- `ignore_time`: Alerts for the same vulnerabilities should occur every `<x>` time specified and not before.
- `interval`: Vulnerabilities scans should start every `<x>` specified time.
- `run_on_start`: If it set to `yes`, vulnerabilities scans and providers feeds update must start when `wazuh-modulesd` process gets started.

## Testing

### Generic tests

- **[test_general_settings_enabled](../doc/test_general_settings/test_general_settings_enabled.md)**: Tests that are
based on modifying the value of `enabled` tag in `ossec.conf` and checking the result in `ossec.log`.

- **[test_general_settings_ignore_time](../doc/test_general_settings/test_general_settings_ignore_time.md)**: Tests that
are based on modifying the value of `ignore_time` tag in `ossec.conf`, setting different times and checking the
result in `ossec.log`.

- **[test_general_settings_interval](../doc/test_general_settings/test_general_settings_interval.md)**: Tests that
are based on modifying the value of `interval` tag in `ossec.conf`, setting different times and checking the
result in `ossec.log`.

- **[test_general_settings_run_on_start](../doc/test_general_settings/test_general_settings_run_on_start.md)**: Tests
that are based on modifying the value of `run_on_start` tag in `ossec.conf` and checking the result in `ossec.log`.
