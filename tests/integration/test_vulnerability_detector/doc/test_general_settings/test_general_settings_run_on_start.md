# Test general settings run on start

The tests will modify the value of `run_on_start` tag in `ossec.conf` and check the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 2 | 12.66s | [test_general_settings_run_on_start.py](../../test_general_settings/test_general_settings_run_on_start.py)|

## Test logic

If `run_on_start` is set to `yes`, the test will check if the scan begins after `wazuh-modulesd` gets started by checking the following pattern in `ossec.log`:

```
(.*)Starting vulnerability scan(.*)
```

If `run_on_start` is set to `no`, the test will check if the scan doesn't begin after `wazuh-modulesd` gets started. This is done by checking if the following pattern doesn't exist in `ossec.log`:

```
(.*)Starting vulnerability scan(.*)
```

## Checks

- [x] Vulnerability scan starts after restarting `wazuh-modulesd` when `run_on_start` is set to `yes`, checking `ossec.log` message.
- [x] Vulnerability scan does not start after restarting `wazuh-modulesd` when `run_on_start` is set to `no`, checking `ossec.log` message.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 2 items

test_vulnerability_detector/test_general_settings/test_general_settings_run_on_start.py ..       [100%]

========================================== 2 passed in 12.66s ==========================================
```
