# Test invalid values Debian feed

 Set of tests that are based on checking the behavior of vulnerability detector when the value of a tag is not
 correct: invalid type, strange characters ...

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 81  | 0:14:38 | [test_invalid_values_debian_feed.py](../../../test_feeds/debian/test_invalid_values_debian_feed.py)|

## Test logic

For each of the following key tags (a key tag is one that needs to be present in the feed in order to be imported)

```
key_tags = ['definitions', 'definition', 'metadata', 'reference', 'criteria']
```

and adding 3 non-key random tags:

```
['product_name', 'affected', 'platform']
```

is assigned the following values:

```
[None, "", "dummy value", 12345, ['1', '2', '3', '4', '5'], "ñ", "テスト",
 "ИСПЫТАНИЕ", "测试", "اختبار"]
```

For instance:

```
<definitions>None</definitions>
```

## Tests

- `test_no_feed_changes`: Check that the feed is imported successfully with the original feed.
- `test_invalid_values_debian_feed`: The tests are based on modifying the feed assigning strange values.

## Checks

- [x] Feed is imported successfully with the original feed.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `Modulesd` is running after the test (don't crash).

## Observed behaviour

The feed will not be imported if:

- The value changed is done in `definitions` tag:

For other cases, the feed will be imported successfully.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 81 items

test_vulnerability_detector/test_feeds/debian/test_invalid_values_debian_feed.py ............... [ 18%]
..................................................................                               [100%]

==================================== 81 passed in 878.62s (0:14:38) ====================================
```
