# Test invalid syntax Red Hat feed

Set of tests that are based on checking the behavior of vulnerability detector when the feed has some kind of syntactic
error: it doesn't have a closing field, it's missing some character ...

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 39 | 0:06:43 | [test_invalid_syntax_redhat_feed.py](../../../test_feeds/redhat/test_invalid_syntax_redhat_feed.py)|

## Test data

A test is performed for each of the following cases:

- Delete `{`
- Delete `}`
- Add `{{`
- Add `}}`
- Add `{` in the middle of feed
- Add `}` in the middle of feed
- Add `{}` in the middle of feed
- Delete key:value comma `,`
- Add a comma before value key: ,value,
- Add comma before any key value `, key:value`
- Add a comma at the end of vulnerability `,}`
- Add double comma after key:value,,
- Add double comma after list value,,
- Close a key with double quotation marks
- Close value with double quotation marks
- Replace a comma with semicolon
- Replace a colon with semicolon
- Missing open bracket
- Missing close bracket
- Delete some information
- For each of the following characters, it has been replaced a `,` character after a field-value

  ```
  ['.', ':', '@', '#', '*', '-', '_', "'", '"', '/', '=', '<', '>',
   '!', '?', '%', '&', '`']
  ```

## Tests

- `test_no_feed_changes`: Check that the feed is imported successfully with the original feed.
- `test_invalid_syntax_redhat_feed`: The tests are based on modifying the feed causing syntax errors.

## Checks

- [x] Feed is imported successfully with the original feed.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `Modulesd` is running after the test (don't crash).

## Observed behaviour

The feed will be imported successfully if:

- Feed has not been modified (imported original feed).

For other cases, the feed will not be imported.

## Execution result

```
========================================== test session starts ==========================================
platform linux -- Python 3.6.8, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: metadata-1.8.0, html-2.0.1, testinfra-5.0.0
collected 39 items

test_vulnerability_detector/test_feeds/redhat/test_invalid_syntax_redhat_feed.py ................ [ 41%]
.......................                                                                           [100%]

==================================== 39 passed in 403.68s (0:06:43) =====================================
```
