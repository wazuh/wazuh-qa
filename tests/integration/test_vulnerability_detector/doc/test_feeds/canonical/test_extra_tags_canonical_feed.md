# Test extra tags Canonical feed

Set of tests that are based on checking the behavior of vulnerability detector when there is any extra tag in the feed.

## General info

|Tier | Number of tests | Time spent|
|:--:|:--:|:--:|
| 2 | 121 | 0:19:33 |

## Test data

For each of the following values a new label `<x>y</x>` will be created.

```
[[1, 2, 3], {"a": 1, "b": 2}, "extra_tag", 12345, "ñ", "テスト", "ИСПЫТАНИЕ", "测试", "اختبار", " ", ""]
```

For instance:

```
<[1, 2, 3]>[1, 2, 3]</[1, 2, 3]>, <[1, 2, 3]>{"a": 1, "b": 2}</[1, 2, 3]>, ...
```

## Tests

- `test_no_feed_changes`: Check that the feed is imported successfully with the original feed
- `test_extra_tags_canonical_feed`: The tests are based on adding new labels formed by each value in test_data

## Checks

- [x] Feed is imported successfully with the original feed
- [x] Vulnerabilities are inserted into the `vulnerabilities` database
- [x] Action status message displayed in `ossec.log`
- [x] Vulnerability detector is running after the test (don't crash)

## Observed behaviour

The feed will be successfully imported if:

- Inserted tag `!= ' '`
- Type of inserted tag is string or integer.

For other cases, the feed will not be imported.


## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 121 items

test_vulnerability_detector/test_feeds/canonical/test_extra_fields_canonical_feeds.py .......... [  8%]
................................................................................................ [ 87%]
...............                                                                                  [100%]

=================================== 121 passed in 1173.47s (0:19:33) ===================================
```