# Test download feeds

Tests that are based on downloading the different feeds (redhat, canonical, debian and NVD) and looking for the message
confirming that the feeds have been downloaded and imported correctly.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 1 | 10 | 0:20:49 | [test_download_feeds.py](../../../test_feeds/test_download_feeds.py)|

**Timeouts**

|Red Hat | Canonical | Debian | NVD |
|:--:|:--:|:--:|:--:|
| 6m | 6m | 6m | 30m |

## Test logic

For each `provider` and `os` the feed is downloaded.

```
RedHat
Canonical: trusty, xenial, bionic and focal
Debian: wheezy, jessie, stretch, buster
NVD
```

The test verifies that the download begins:

```
Starting '<system>' database update
```

and that it ends correctly:

```
The update of the '<system>' feed finished successfully
```

## Checks

- [x] Starting database update
- [x] The update has finished successfully

## Observed behaviour

Downloading the feeds and updating the database is done correctly.

## Execution result

```
=========================================================================== test session starts ============================================================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 10 items

test_vulnerability_detector/test_feeds/test_download_feeds.py ..........                         [100%]

=================================== 10 passed in 1249.31s (0:20:49) ====================================
```
