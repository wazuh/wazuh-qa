# Test invalid type custom feeds

Tests that are based on importing files of several different types (`.mp3`, `.jpg`, `.pdf` ...) as custom feed, and
observing the response of vulnerability detector.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 40 | 0:01:23 | [test_invalid_type_custom_feeds.py](../../../test_feeds/test_invalid_type_custom_feeds.py)|

## Test logic

For each of the following extensions:

```
['', '.avi', '.doc', '.jpg', '.json', '.xml', '.mp3', '.pdf', '.zip']
```

A file with that extension is downloaded and inserted as a custom feed in the set of providers:

```
[Redhat, Canonical, Debian, NVD]
```

In addition, it is added a correctly feed to test if this is imported successfully.

## Tests

- `test_invalid_type_custom_feeds`: Tests to import custom files as feeds for different providers.

## Checks

- [x] A correct feed is imported successfully.
- [x] A no feed file with an invalid extension is detected and not imported.

## Observed behaviour

In general vulnerability detector realizes that it is an invalid file and discards it, **except for when trying to
import for NVD**, which in this case says that it imports it correctly when in fact this is not the case.

**Xfailing** when importing custom files as NVD feeds (https://github.com/wazuh/wazuh/issues/5210).

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 40 items

test_vulnerability_detector/test_feeds/test_invalid_type_custom_feeds.py ....................... [ 57%]
.......xxxxxxxxxx                                                                                [100%]

============================== 30 passed, 10 xfailed in 83.46s (0:01:23) ===============================
```
