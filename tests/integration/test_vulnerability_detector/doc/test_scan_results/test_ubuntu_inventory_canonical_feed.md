# Test Ubuntu inventory Canonical feed

These tests will mock Ubuntu systems and insert custom vulnerabilities and vulnerable packages to check if Vulnerability
Detector generates the vulnerability alerts from Canonical provider feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 4 | 0:01:01 | [test_ubuntu_inventory_canonical_feed.py](../../test_scan_results/test_ubuntu_inventory_canonical_feed.py)|

## Test logic

For each Ubuntu systems:

```
FOCAL, BIONIC, XENIAL, TRUSTY
```

The test will run these actions:
- Clean NVD, `vulnerabilities`, and `sys_programs tables`.
- Mock the system.
- Insert [custom feed and vulnerable packages for Ubuntu](../../test_scan_results/data/ubuntu_vulnerabilities.json).
- Import NVD vulnerabilities from [custom NVD feed](../../test_scan_results/data/real_nvd_feed.json).
- Check `ossec.log` events.

## Checks

- [x] The number of vulnerabilities report by `OVAL` is as expected.
- [x] A report of the corresponding vulnerabilities is generated in the `ossec.log`.
- [x] `wazuh-modulesd` is still running once the test has finished (it didn't crash).

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================== test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 4 items

test_vulnerability_detector/test_scan_results/test_ubuntu_inventory_canonical_feed.py ....        [100%]

===================================== 4 passed in 61.55s (0:01:01) ======================================
```
