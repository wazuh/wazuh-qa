# Test providers update from year

Tests that are based on modifying the value of `update_from_year` tag in `ossec.conf`, setting different years and
checking the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 16 | 0:01:35s| [test_providers_update_from_year.py](../../test_providers/test_providers_update_from_year.py)|

## Test logic

For each one the following providers and years:

```
providers = ['nvd', 'redhat']
years = [1998, 1999, 2001, 2002, 2005, 2010, 2015, 2020]
```

it is checked the vulnerability detector behavior when it is set the `x` year for `y` provider, taking into account
that the minimum years for each provider are:

```
Red Hat: 1999
NVD: 2002
```

For those years that are invalid for the provider, an error message and an exception is expected when wazuh is not
restarted correctly due to an ossec configuration failure.

For those valid years, it is expected that their respective log will be found and none from a previous year.
```

## Checks

- [x] `ossec.conf` error when it is set an invalid year for the provider
- [x] Download the feed of the established year
- [x] No feeds from previous years are downloaded

## Observed behaviour

The expected behavior is carried out

## Execution result

```
========================================== test session starts ==========================================
platform linux -- Python 3.8.2, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, testinfra-5.0.0, metadata-1.8.0
collected 16 items

test_vulnerability_detector/test_providers/test_providers_update_from_year.py ................    [100%]

===================================== 16 passed in 95.71s (0:01:35) =====================================
```
