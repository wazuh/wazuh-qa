# Test providers enabled

Tests that are based on modifying the value of `enabled` tag in `ossec.conf` and checking the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 8 | 54.68s | [test_providers_enabled.py](../../test_providers/test_providers_enabled.py)|

## Test logic

If `enabled` is `yes` then check the following pattern in `ossec.log`:

```
(.*)Starting '<provider_name>' database update
```

If `enabled` is `no` then check that following pattern does not appear in `ossec.log`:

```
(.*)Starting '<provider_name>' database update
```

## Checks

- [x] Provider data updatating starts when `enabled` `yes`
- [x] Provider data updatating doest not start when `enabled` `no`

## Observed behaviour

The expected behavior is carried out

## Execution result

```
========================================= test session starts =========================================
platform linux -- Python 3.8.2, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, testinfra-5.0.0, metadata-1.8.0
collected 8 items

test_vulnerability_detector/test_providers/test_providers_enabled.py ........                   [100%]

========================================= 8 passed in 54.68s ==========================================
```
