# Test update interval

Tests that are based on modifying the value of `interval` tag in `ossec.conf`, setting different time intervals and
units, and checking the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 16 | 0:03:17 | [test_providers_update_interval.py](../../test_providers/test_providers_update_interval.py)|

## Test logic

For each provider (Red Hat, Canonical, Debian and NVD) it is set the following time units in `<update_interval>`:

```
['60s', '60m', '1h', '1d']
```

the following is done:

- Check that os provider updating has not started prematurely.
- Advance the time clock just after the set time and check that provider updating has started.

## Checks

- [x] Provider os has not started before the update interval set.
- [x] Provider os has started just after the update interval set.

## Observed behaviour

The expected behavior is carried out

## Execution result

```
========================================= test session starts =========================================
platform linux -- Python 3.8.2, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, testinfra-5.0.0, metadata-1.8.0
collected 16 items

test_vulnerability_detector/test_providers/test_update_interval.py ................             [100%]

=================================== 16 passed in 197.45s (0:03:17) ====================================
```
