# Test providers os

Tests that are based on modifying the value of `os` tag in `ossec.conf`, setting different os for Canonical and Debian
and checking the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 9 | 18.80s | [test_providers_os.py](../../test_providers/test_providers_os.py)|

## Test logic

For each one the following elements

```
{'PROVIDER': 'canonical', 'OS': 'trusty'},
{'PROVIDER': 'canonical', 'OS': 'xenial'},
{'PROVIDER': 'canonical', 'OS': 'bionic'},
{'PROVIDER': 'debian', 'OS': 'wheezy'},
{'PROVIDER': 'debian', 'OS': 'stretch'},
{'PROVIDER': 'debian', 'OS': 'jessie'},
{'PROVIDER': 'debian', 'OS': 'buster'},
{'PROVIDER': 'redhat', 'OS': ''},
{'PROVIDER': 'nvd', 'OS': ''},
```

it is modified the `ossec.conf` with `os` provider, and then check:

- If `os` provider has value (Canonical and Debian), then check the following pattern in `ossec.log`

```
(.*)Starting '<provider_name>' database update
```

- If `os` provider has not value (Red Hat and NVD), then check the following pattern in `ossec.log`:

```
(.*)Could not find: warning 'os' option can only be used in a single-provider
```

## Checks

- [x] Provider os data updatating starts when `os` has a determined value.
- [x] It is shown a warning when use `os` tag in Red Hat and NVD providers.

## Observed behaviour

The expected behavior is carried out

## Execution result

```
======================================== test session starts =========================================
platform linux -- Python 3.8.2, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, testinfra-5.0.0, metadata-1.8.0
collected 9 items

test_vulnerability_detector/test_providers/test_providers_os.py .........                       [100%]

========================================= 9 passed in 18.80s ==========================================
```
