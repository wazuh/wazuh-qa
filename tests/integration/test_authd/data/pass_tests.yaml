---
  #PASSWORD test
  -
    name: "Default USE_PASSWORD request with password use_password enabled"
    description: "Try register an agent with password and use_password enabled: register"
    test_case:
    -
      input: "OSSEC PASS: TopSecret OSSEC A:'user1'"
      output: "OSSEC K:'001 user1 any "
      insert_prev_agent: "no"
    USE_PASSWORD: "yes"
  -
    name: "Manager without password"
    description: "Try register an agent without password and use_password disabled: register"
    test_case:
    -
      input: "OSSEC A:'user1'"
      output: "OSSEC K:'001 user1 any "
      insert_prev_agent: "no"
    USE_PASSWORD: "no"
  -
    name: "Manager without password, request with password"
    description: "Try register an agent with password and use_password disabled: rejected"
    test_case:
    -
      input: "OSSEC PASS: TopSecret OSSEC A:'user1'"
      output: "ERROR: Invalid request for new agent"
      insert_prev_agent: "no"
    USE_PASSWORD: "no"
  -
    name: "Manager with password, request with correct password"
    description: "Try register an agent with correct password and use_password enabled: register"
    test_case:
    -
      input: "OSSEC PASS: TopSecret OSSEC A:'user1'"
      output: "OSSEC K:'001 user1 any "
      insert_prev_agent: "no"
    USE_PASSWORD: "yes"
  -
    name: "Manager with password, request with wrong password"
    description: "Try register an agent with password and use_password enabled: rejected"
    test_case:
    -
      input: "OSSEC PASS: wrongPass OSSEC A:'user1'"
      output: "ERROR: Invalid password"
      insert_prev_agent: "no"
    USE_PASSWORD: "yes"
  -
    name: "Random password, request with correct password"
    description: "Try register an agent with correct password and use_password enabled, random password created: register"
    test_case:
    -
      input: "OSSEC PASS: {} OSSEC A:'user1'"
      output: "OSSEC K:'001 user1 any "
      insert_prev_agent: "no"
      insert_random_pass_in_query: "yes"

    USE_PASSWORD: "yes"
    random_pass: "yes"
  -
    name: "Random password, request with wrong password"
    description: "Try register an agent with wrong password and use_password enabled, random password created: rejected"
    test_case:
    -
      input: "OSSEC PASS: wrongPass OSSEC A:'user1'"
      output: "ERROR: Invalid password"
      insert_prev_agent: "no"
    USE_PASSWORD: "yes"
    random_pass: "yes"
  -
    name: "Random password, request without password"
    description: "Try register an agent without password and use_password enabled, random password created: rejected"
    test_case:
    -
      input: "OSSEC A:'user1'"
      output: "ERROR: Invalid password"
      insert_prev_agent: "no"
    USE_PASSWORD: "yes"
    random_pass: "yes"
