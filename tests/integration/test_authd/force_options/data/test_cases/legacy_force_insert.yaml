-
  name: "Force insert enabled"
  description: "Chack that legacy force_insert overrides force.enabled"
  configuration:
  - force:
      elements:
      - enabled:
          value: 'yes'
      - key_mismatch:
          value: 'no'
      - disconnected_time:
          attributes:
          - enabled: 'no'
          value: 0
      - after_registration_time:
          value: 0
  - force_insert :
      value: 'no'
  pre_existent_agents:
    - id: 001
      name: user1
      ip: any
      key: TopSecret
      connection_status: disconnected
      disconnection_time:
        value: 10
      registration_time:
        delta: -100
  log:
    - The <force_insert> tag is deprecated since version 4.3.0.
    - Setting <force><enabled> tag to no to comply with the legacy <force_insert> option found.
  test_case:
  -
    input:
      name: 'user1'
    output:
      status: 'error'
    log:
      - Duplicate name 'user1', rejecting enrollment. Agent '1' won't be removed because the force option is disabled.