-
  name: "Default Name"
  description: "No agent name in auto enrollment configuration"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Valid agent address"
  description: "Check a valid agent_address configurations"
  configuration:
    agent_address: "192.168.0.10"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}' IP:'192.168.0.10'\n"
    response: "OSSEC K:'001 {host_name} 192.168.0.10 TopSecret'\n"
-
  name: "Valid agent address CIDR"
  description: "Check a valid agent_address configurations CIDR"
  configuration:
    agent_address: "192.168.0.10/24"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}' IP:'192.168.0.10/24'\n"
    response: "OSSEC K:'001 {host_name} 192.168.0.10/24 TopSecret'\n"
-
  name: "Invalid Agent address CIDR"
  description: "Check a invalid CIDR agent_address in auto enrollment configuration"
  configuration:
    agent_address: "192.168.0.10/100"
  expected_error: "ERROR: (4104): Invalid hostname: '192.168.0.10/100'."
  #Known Issue: Invalid CIDR is not checked. Skiped
  skips:
    - agent-auth
    - wazuh-agentd
-
  name: "Invalid Agent address"
  description: "Check a invalid agent_address in auto enrollment configuration"
  configuration:
    agent_address: "192.168.0.1000"
  expected_error: "ERROR: (4104): Invalid hostname: '192.168.0.1000'."
  #Known Issue: Invalid adress is not checked. Skiped
  skips:
    - agent-auth
    - wazuh-agentd
-
  name: "Valid manager address"
  description: "Check a valid manager_address configurations"
  skips:
    - agent-auth
  configuration:
    manager_address: "127.0.0.1"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Groups"
  description: "Agent groups in auto enrollment configuration"
  configuration:
    groups: "group_1"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}' G:'group_1'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Multi Groups"
  description: "Agent multi groups in auto enrollment configuration"
  configuration:
    groups: "group_1,group_2"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}' G:'group_1,group_2'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Invalid enabled"
  description: "Check a invalid enabled in auto enrollment configuration"
  skips:
    - agent-auth
  configuration:
    enabled: "nn"
  expected_error: "ERROR: Invalid content for tag 'enabled'."
-
  name: "Valid agent name config"
  description: "Check a valid agent_name configurations"
  configuration:
    agent_name: "test_agent"
    pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'test_agent'\n"
    response: "OSSEC K:'001 test_agent any TopSecret'\n"
-
  name: "Valid agent name config max length"
  description: "Check a valid agent_name configurations max length"
  configuration:
    agent_name: "nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn'\n"
    response: "OSSEC K:'001 nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn any TopSecret'\n"
-
  name: "Invalid agent name config"
  description: "Check a invalid agent_name configurations"
  configuration:
    agent_name: "test_agent/+bad"
  expected_error: "ERROR: Invalid agent name"
-
  name: "Invalid agent name config - too short"
  description: "Check a invalid agent_name configurations too short"
  configuration:
    agent_name: "n"
  expected_error: "ERROR: Invalid agent name"
-
  name: "Invalid agent name config - too long"
  description: "Check a invalid agent_name configurations too long"
  configuration:
    agent_name: "nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn"
  expected_error: "ERROR: Invalid agent name"
-
  name: "Use source IP"
  description: "Check that source IP is sent by agent"
  configuration:
    use_source_ip: "yes"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC A:'{host_name}' IP:'src'\n"
    response: "OSSEC K:'001 {host_name} 192.168.0.10 TopSecret'\n"
-
  name: "Incompatible - Use source IP"
  description: "Use source IP option while trying to set an IP"
  configuration:
    use_source_ip: "yes"
    agent_address: "127.0.0.1"
  expected_error: "ERROR: Options '-I' and '-i' are uncompatible."
-
  name: "Password from string - Agent-Auth"
  description: "Check that configured password is sent on string"
  skips:
    - wazuh-agentd
  configuration:
    password:
      type: "string"
      value: "pass123"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC PASS: pass123 OSSEC A:'{host_name}'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Password from file - Agent-Auth"
  description: "Check that password file is open and read successfully"
  skips:
    - wazuh-agentd
  configuration:
    password:
      type: "file"
      value: "pass123"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC PASS: pass123 OSSEC A:'{host_name}'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Password from file - Agentd"
  description: "Check that password file is open and read successfully"
  skips:
    - agent-auth
  configuration:
    authorization_pass_path: "{PASSWORD_PATH}"
    password:
      value: "pass123"
  pre_existent_keys:
    - ""
  message:
    expected: "OSSEC PASS: pass123 OSSEC A:'{host_name}'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Valid port"
  description: "Check a valid port configurations"
  skips:
    - agent-auth
  configuration:
    port: 1515
  pre_existent_keys:
    - ""
  message:
    expected: " OSSEC A:'{host_name}'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
-
  name: "Invalid port 65536"
  description: "Check a invalid port configurations 65536"
  skips:
    - agent-auth
  configuration:
    port: 65536
  expected_error: "(1205): Invalid port number: '65536'"
-
  name: "Invalid port 0"
  description: "Check a invalid port configurations 0"
  skips:
    - agent-auth
  configuration:
    port: 0
  expected_error: "(1205): Invalid port number: '0'"
-
  name: "Invalid port -1515"
  description: "Check a invalid port configurations -1515"
  skips:
    - agent-auth
  configuration:
    port: -1515
  expected_error: "ERROR: (1235): Invalid value for element 'port': -1515."
-
  name: "Default Name with key hash"
  description: "Check the default message when having a key hash"
  pre_existent_keys:
    - "001 test_name any TopSecret"
  message:
    expected: "OSSEC A:'{host_name}' K:'5f7b611efd8882c0b11d87d284158faefafddf21'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
  debug: 'yes'

-
  name: "Valid agent address with key hash"
  description: "Check a valid agent_address configurations when having a key hash"
  configuration:
    agent_address: "192.168.0.10"
  pre_existent_keys:
    - "001 test_name any TopSecret"
  message:
    expected: "OSSEC A:'{host_name}' IP:'192.168.0.10' K:'5f7b611efd8882c0b11d87d284158faefafddf21'\n"
    response: "OSSEC K:'001 {host_name} 192.168.0.10 TopSecret' K:'5f7b611efd8882c0b11d87d284158faefafddf21'\n"
-
  name: "Groups with key hash"
  description: "Check a registration command with groups and key hash"
  configuration:
    groups: "group_1"
  pre_existent_keys:
    - "001 test_name any TopSecret"
  message:
    expected: "OSSEC A:'{host_name}' G:'group_1' K:'5f7b611efd8882c0b11d87d284158faefafddf21'\n"
    response: "OSSEC K:'001 {host_name} any TopSecret'\n"
