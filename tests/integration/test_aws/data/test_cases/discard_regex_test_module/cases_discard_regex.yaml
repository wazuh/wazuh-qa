- name: cloudtrail_discard_regex
  description: CloudTrail discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: cloudtrail
    BUCKET_NAME: wazuh-cloudtrail-integration-tests
    DISCARD_FIELD: eventSource
    DISCARD_REGEX: .*ec2.amazonaws.com.*
  metadata:
    bucket_type: cloudtrail
    bucket_name: wazuh-cloudtrail-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: eventSource
    discard_regex: .*ec2.amazonaws.com.*
    found_logs: 5
    skipped_logs: 1

- name: vpc_discard_regex
  description: VPC discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: vpcflow
    BUCKET_NAME: wazuh-vpcflow-integration-tests
    DISCARD_FIELD: srcport
    DISCARD_REGEX: "5319"
  metadata:
    bucket_type: vpcflow
    bucket_name: wazuh-vpcflow-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: srcport
    discard_regex: "5319"
    found_logs: 5
    skipped_logs: 1

- name: config_discard_regex
  description: Config discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: config
    BUCKET_NAME: wazuh-config-integration-tests
    DISCARD_FIELD: configuration.complianceType
    DISCARD_REGEX: .*COMPLIANT.*
  metadata:
    bucket_type: config
    bucket_name: wazuh-config-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: configuration.complianceType
    discard_regex: .*COMPLIANT.*
    found_logs: 5
    skipped_logs: 1

- name: alb_discard_regex
  description: ALB discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: alb
    BUCKET_NAME: wazuh-alb-integration-tests
    DISCARD_FIELD: elb_status_code
    DISCARD_REGEX: '401'
  metadata:
    bucket_type: alb
    bucket_name: wazuh-alb-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: elb_status_code
    discard_regex: '401'
    found_logs: 5
    skipped_logs: 1

- name: clb_discard_regex
  description: CLB discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: clb
    BUCKET_NAME: wazuh-clb-integration-tests
    DISCARD_FIELD: elb_status_code
    DISCARD_REGEX: '401'
  metadata:
    bucket_type: clb
    bucket_name: wazuh-clb-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: elb_status_code
    discard_regex: '401'
    found_logs: 5
    skipped_logs: 1

- name: nlb_discard_regex
  description: NLB discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: nlb
    BUCKET_NAME: wazuh-nlb-integration-tests
    DISCARD_FIELD: listener
    DISCARD_REGEX: 0CMK2UAG108C7AXK
  metadata:
    bucket_type: nlb
    bucket_name: wazuh-nlb-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: listener
    discard_regex: 0CMK2UAG108C7AXK
    found_logs: 5
    skipped_logs: 1

- name: kms_discard_regex
  description: KMS discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: custom
    BUCKET_NAME: wazuh-kms-integration-tests
    DISCARD_FIELD: eventName
    DISCARD_REGEX: MatchDataKey
  metadata:
    bucket_type: custom
    bucket_name: wazuh-kms-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: eventName
    discard_regex: MatchDataKey
    found_logs: 3
    skipped_logs: 1

- name: macie_discard_regex
  description: Macie discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: custom
    BUCKET_NAME: wazuh-macie-integration-tests
    DISCARD_FIELD: severity
    DISCARD_REGEX: LOW
  metadata:
    bucket_type: custom
    bucket_name: wazuh-macie-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: severity
    discard_regex: LOW
    found_logs: 3
    skipped_logs: 1

- name: trusted_advisor_discard_regex
  description: Trusted Advisor discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: custom
    BUCKET_NAME: wazuh-trusted-advisor-integration-tests
    DISCARD_FIELD: status
    DISCARD_REGEX: ERROR
  metadata:
    bucket_type: custom
    bucket_name: wazuh-trusted-advisor-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: status
    discard_regex: ERROR
    found_logs: 3
    skipped_logs: 1

- name: guardduty_discard_regex
  description: GuardDuty discard regex configurations
  configuration_parameters:
    BUCKET_TYPE: guardduty
    BUCKET_NAME: wazuh-guardduty-integration-tests
    DISCARD_FIELD: partition
    DISCARD_REGEX: aws-test
  metadata:
    bucket_type: guardduty
    bucket_name: wazuh-guardduty-integration-tests
    only_logs_after: 2022-NOV-20
    discard_field: partition
    discard_regex: aws-test
    found_logs: 3
    skipped_logs: 1
