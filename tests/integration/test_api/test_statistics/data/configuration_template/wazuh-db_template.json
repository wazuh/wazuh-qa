{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "properties": {
      "data": {
        "type": "object",
        "properties": {
          "affected_items": {
            "type": "array",
            "items": [
              {
                "type": "object",
                "properties": {
                  "uptime": {
                    "type": "string"
                  },
                  "timestamp": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string",
                    "pattern": "^wazuh-db$"
                  },
                  "metrics": {
                    "type": "object",
                    "properties": {
                      "queries": {
                        "type": "object",
                        "properties": {
                          "received": {
                            "type": "integer"
                          },
                          "received_breakdown": {
                            "type": "object",
                            "properties": {
                              "agent": {
                                "type": "integer"
                              },
                              "agent_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "begin": {
                                        "type": "integer"
                                      },
                                      "close": {
                                        "type": "integer"
                                      },
                                      "commit": {
                                        "type": "integer"
                                      },
                                      "remove": {
                                        "type": "integer"
                                      },
                                      "sql": {
                                        "type": "integer"
                                      },
                                      "vacuum": {
                                        "type": "integer"
                                      },
                                      "get_fragmentation": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "begin",
                                      "close",
                                      "commit",
                                      "remove",
                                      "sql",
                                      "vacuum",
                                      "get_fragmentation"
                                    ]
                                  },
                                  "tables": {
                                    "type": "object",
                                    "properties": {
                                      "ciscat": {
                                        "type": "object",
                                        "properties": {
                                          "ciscat": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "ciscat"
                                        ]
                                      },
                                      "rootcheck": {
                                        "type": "object",
                                        "properties": {
                                          "rootcheck": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "rootcheck"
                                        ]
                                      },
                                      "sca": {
                                        "type": "object",
                                        "properties": {
                                          "sca": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "sca"
                                        ]
                                      },
                                      "sync": {
                                        "type": "object",
                                        "properties": {
                                          "dbsync": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "dbsync"
                                        ]
                                      },
                                      "syscheck": {
                                        "type": "object",
                                        "properties": {
                                          "fim_file": {
                                            "type": "integer"
                                          },
                                          "fim_registry": {
                                            "type": "integer"
                                          },
                                          "syscheck": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "fim_file",
                                          "fim_registry",
                                          "syscheck"
                                        ]
                                      },
                                      "syscollector": {
                                        "type": "object",
                                        "properties": {
                                          "syscollector_hotfixes": {
                                            "type": "integer"
                                          },
                                          "syscollector_hwinfo": {
                                            "type": "integer"
                                          },
                                          "syscollector_network_address": {
                                            "type": "integer"
                                          },
                                          "syscollector_network_iface": {
                                            "type": "integer"
                                          },
                                          "syscollector_network_protocol": {
                                            "type": "integer"
                                          },
                                          "syscollector_osinfo": {
                                            "type": "integer"
                                          },
                                          "syscollector_packages": {
                                            "type": "integer"
                                          },
                                          "syscollector_ports": {
                                            "type": "integer"
                                          },
                                          "syscollector_processes": {
                                            "type": "integer"
                                          },
                                          "deprecated": {
                                            "type": "object",
                                            "properties": {
                                              "hardware": {
                                                "type": "integer"
                                              },
                                              "hotfix": {
                                                "type": "integer"
                                              },
                                              "netaddr": {
                                                "type": "integer"
                                              },
                                              "netinfo": {
                                                "type": "integer"
                                              },
                                              "netproto": {
                                                "type": "integer"
                                              },
                                              "osinfo": {
                                                "type": "integer"
                                              },
                                              "package": {
                                                "type": "integer"
                                              },
                                              "port": {
                                                "type": "integer"
                                              },
                                              "process": {
                                                "type": "integer"
                                              }
                                            },
                                            "required": [
                                              "hardware",
                                              "hotfix",
                                              "netaddr",
                                              "netinfo",
                                              "netproto",
                                              "osinfo",
                                              "package",
                                              "port",
                                              "process"
                                            ]
                                          }
                                        },
                                        "required": [
                                          "syscollector_hotfixes",
                                          "syscollector_hwinfo",
                                          "syscollector_network_address",
                                          "syscollector_network_iface",
                                          "syscollector_network_protocol",
                                          "syscollector_osinfo",
                                          "syscollector_packages",
                                          "syscollector_ports",
                                          "syscollector_processes",
                                          "deprecated"
                                        ]
                                      },
                                      "vulnerability": {
                                        "type": "object",
                                        "properties": {
                                          "vuln_cves": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "vuln_cves"
                                        ]
                                      }
                                    },
                                    "required": [
                                      "ciscat",
                                      "rootcheck",
                                      "sca",
                                      "sync",
                                      "syscheck",
                                      "syscollector",
                                      "vulnerability"
                                    ]
                                  }
                                },
                                "required": [
                                  "db",
                                  "tables"
                                ]
                              },
                              "global": {
                                "type": "integer"
                              },
                              "global_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "backup": {
                                        "type": "integer"
                                      },
                                      "sql": {
                                        "type": "integer"
                                      },
                                      "vacuum": {
                                        "type": "integer"
                                      },
                                      "get_fragmentation": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "backup",
                                      "sql",
                                      "vacuum",
                                      "get_fragmentation"
                                    ]
                                  },
                                  "tables": {
                                    "type": "object",
                                    "properties": {
                                      "agent": {
                                        "type": "object",
                                        "properties": {
                                          "delete-agent": {
                                            "type": "integer"
                                          },
                                          "disconnect-agents": {
                                            "type": "integer"
                                          },
                                          "find-agent": {
                                            "type": "integer"
                                          },
                                          "get-agent-info": {
                                            "type": "integer"
                                          },
                                          "get-agents-by-connection-status": {
                                            "type": "integer"
                                          },
                                          "get-all-agents": {
                                            "type": "integer"
                                          },
                                          "get-groups-integrity": {
                                            "type": "integer"
                                          },
                                          "insert-agent": {
                                            "type": "integer"
                                          },
                                          "reset-agents-connection": {
                                            "type": "integer"
                                          },
                                          "select-agent-group": {
                                            "type": "integer"
                                          },
                                          "select-agent-name": {
                                            "type": "integer"
                                          },
                                          "set-agent-groups": {
                                            "type": "integer"
                                          },
                                          "sync-agent-groups-get": {
                                            "type": "integer"
                                          },
                                          "sync-agent-info-get": {
                                            "type": "integer"
                                          },
                                          "sync-agent-info-set": {
                                            "type": "integer"
                                          },
                                          "update-agent-data": {
                                            "type": "integer"
                                          },
                                          "update-agent-name": {
                                            "type": "integer"
                                          },
                                          "update-connection-status": {
                                            "type": "integer"
                                          },
                                          "update-keepalive": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "delete-agent",
                                          "disconnect-agents",
                                          "find-agent",
                                          "get-agent-info",
                                          "get-agents-by-connection-status",
                                          "get-all-agents",
                                          "get-groups-integrity",
                                          "insert-agent",
                                          "reset-agents-connection",
                                          "select-agent-group",
                                          "select-agent-name",
                                          "set-agent-groups",
                                          "sync-agent-groups-get",
                                          "sync-agent-info-get",
                                          "sync-agent-info-set",
                                          "update-agent-data",
                                          "update-agent-name",
                                          "update-connection-status",
                                          "update-keepalive"
                                        ]
                                      },
                                      "belongs": {
                                        "type": "object",
                                        "properties": {
                                          "get-group-agents": {
                                            "type": "integer"
                                          },
                                          "select-group-belong": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "get-group-agents",
                                          "select-group-belong"
                                        ]
                                      },
                                      "group": {
                                        "type": "object",
                                        "properties": {
                                          "delete-group": {
                                            "type": "integer"
                                          },
                                          "find-group": {
                                            "type": "integer"
                                          },
                                          "insert-agent-group": {
                                            "type": "integer"
                                          },
                                          "select-groups": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "delete-group",
                                          "find-group",
                                          "insert-agent-group",
                                          "select-groups"
                                        ]
                                      },
                                      "labels": {
                                        "type": "object",
                                        "properties": {
                                          "get-labels": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "get-labels"
                                        ]
                                      }
                                    },
                                    "required": [
                                      "agent",
                                      "belongs",
                                      "group",
                                      "labels"
                                    ]
                                  }
                                },
                                "required": [
                                  "db",
                                  "tables"
                                ]
                              },
                              "mitre": {
                                "type": "integer"
                              },
                              "mitre_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "sql": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "sql"
                                    ]
                                  }
                                },
                                "required": [
                                  "db"
                                ]
                              },
                              "task": {
                                "type": "integer"
                              },
                              "task_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "sql": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "sql"
                                    ]
                                  },
                                  "tables": {
                                    "type": "object",
                                    "properties": {
                                      "tasks": {
                                        "type": "object",
                                        "properties": {
                                          "delete_old": {
                                            "type": "integer"
                                          },
                                          "set_timeout": {
                                            "type": "integer"
                                          },
                                          "upgrade": {
                                            "type": "integer"
                                          },
                                          "upgrade_cancel_tasks": {
                                            "type": "integer"
                                          },
                                          "upgrade_custom": {
                                            "type": "integer"
                                          },
                                          "upgrade_get_status": {
                                            "type": "integer"
                                          },
                                          "upgrade_result": {
                                            "type": "integer"
                                          },
                                          "upgrade_update_status": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "delete_old",
                                          "set_timeout",
                                          "upgrade",
                                          "upgrade_cancel_tasks",
                                          "upgrade_custom",
                                          "upgrade_get_status",
                                          "upgrade_result",
                                          "upgrade_update_status"
                                        ]
                                      }
                                    },
                                    "required": [
                                      "tasks"
                                    ]
                                  }
                                },
                                "required": [
                                  "db",
                                  "tables"
                                ]
                              },
                              "wazuhdb": {
                                "type": "integer"
                              },
                              "wazuhdb_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "remove": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "remove"
                                    ]
                                  }
                                },
                                "required": [
                                  "db"
                                ]
                              }
                            },
                            "required": [
                              "agent",
                              "agent_breakdown",
                              "global",
                              "global_breakdown",
                              "mitre",
                              "mitre_breakdown",
                              "task",
                              "task_breakdown",
                              "wazuhdb",
                              "wazuhdb_breakdown"
                            ]
                          }
                        },
                        "required": [
                          "received",
                          "received_breakdown"
                        ]
                      },
                      "time": {
                        "type": "object",
                        "properties": {
                          "execution": {
                            "type": "integer"
                          },
                          "execution_breakdown": {
                            "type": "object",
                            "properties": {
                              "agent": {
                                "type": "integer"
                              },
                              "agent_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "begin": {
                                        "type": "integer"
                                      },
                                      "close": {
                                        "type": "integer"
                                      },
                                      "commit": {
                                        "type": "integer"
                                      },
                                      "remove": {
                                        "type": "integer"
                                      },
                                      "sql": {
                                        "type": "integer"
                                      },
                                      "vacuum": {
                                        "type": "integer"
                                      },
                                      "get_fragmentation": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "begin",
                                      "close",
                                      "commit",
                                      "remove",
                                      "sql",
                                      "vacuum",
                                      "get_fragmentation"
                                    ]
                                  },
                                  "tables": {
                                    "type": "object",
                                    "properties": {
                                      "ciscat": {
                                        "type": "object",
                                        "properties": {
                                          "ciscat": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "ciscat"
                                        ]
                                      },
                                      "rootcheck": {
                                        "type": "object",
                                        "properties": {
                                          "rootcheck": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "rootcheck"
                                        ]
                                      },
                                      "sca": {
                                        "type": "object",
                                        "properties": {
                                          "sca": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "sca"
                                        ]
                                      },
                                      "sync": {
                                        "type": "object",
                                        "properties": {
                                          "dbsync": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "dbsync"
                                        ]
                                      },
                                      "syscheck": {
                                        "type": "object",
                                        "properties": {
                                          "fim_file": {
                                            "type": "integer"
                                          },
                                          "fim_registry": {
                                            "type": "integer"
                                          },
                                          "syscheck": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "fim_file",
                                          "fim_registry",
                                          "syscheck"
                                        ]
                                      },
                                      "syscollector": {
                                        "type": "object",
                                        "properties": {
                                          "syscollector_hotfixes": {
                                            "type": "integer"
                                          },
                                          "syscollector_hwinfo": {
                                            "type": "integer"
                                          },
                                          "syscollector_network_address": {
                                            "type": "integer"
                                          },
                                          "syscollector_network_iface": {
                                            "type": "integer"
                                          },
                                          "syscollector_network_protocol": {
                                            "type": "integer"
                                          },
                                          "syscollector_osinfo": {
                                            "type": "integer"
                                          },
                                          "syscollector_packages": {
                                            "type": "integer"
                                          },
                                          "syscollector_ports": {
                                            "type": "integer"
                                          },
                                          "syscollector_processes": {
                                            "type": "integer"
                                          },
                                          "deprecated": {
                                            "type": "object",
                                            "properties": {
                                              "hardware": {
                                                "type": "integer"
                                              },
                                              "hotfix": {
                                                "type": "integer"
                                              },
                                              "netaddr": {
                                                "type": "integer"
                                              },
                                              "netinfo": {
                                                "type": "integer"
                                              },
                                              "netproto": {
                                                "type": "integer"
                                              },
                                              "osinfo": {
                                                "type": "integer"
                                              },
                                              "package": {
                                                "type": "integer"
                                              },
                                              "port": {
                                                "type": "integer"
                                              },
                                              "process": {
                                                "type": "integer"
                                              }
                                            },
                                            "required": [
                                              "hardware",
                                              "hotfix",
                                              "netaddr",
                                              "netinfo",
                                              "netproto",
                                              "osinfo",
                                              "package",
                                              "port",
                                              "process"
                                            ]
                                          }
                                        },
                                        "required": [
                                          "syscollector_hotfixes",
                                          "syscollector_hwinfo",
                                          "syscollector_network_address",
                                          "syscollector_network_iface",
                                          "syscollector_network_protocol",
                                          "syscollector_osinfo",
                                          "syscollector_packages",
                                          "syscollector_ports",
                                          "syscollector_processes",
                                          "deprecated"
                                        ]
                                      },
                                      "vulnerability": {
                                        "type": "object",
                                        "properties": {
                                          "vuln_cves": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "vuln_cves"
                                        ]
                                      }
                                    },
                                    "required": [
                                      "ciscat",
                                      "rootcheck",
                                      "sca",
                                      "sync",
                                      "syscheck",
                                      "syscollector",
                                      "vulnerability"
                                    ]
                                  }
                                },
                                "required": [
                                  "db",
                                  "tables"
                                ]
                              },
                              "global": {
                                "type": "integer"
                              },
                              "global_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "backup": {
                                        "type": "integer"
                                      },
                                      "sql": {
                                        "type": "integer"
                                      },
                                      "vacuum": {
                                        "type": "integer"
                                      },
                                      "get_fragmentation": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "backup",
                                      "sql",
                                      "vacuum",
                                      "get_fragmentation"
                                    ]
                                  },
                                  "tables": {
                                    "type": "object",
                                    "properties": {
                                      "agent": {
                                        "type": "object",
                                        "properties": {
                                          "delete-agent": {
                                            "type": "integer"
                                          },
                                          "disconnect-agents": {
                                            "type": "integer"
                                          },
                                          "find-agent": {
                                            "type": "integer"
                                          },
                                          "get-agent-info": {
                                            "type": "integer"
                                          },
                                          "get-agents-by-connection-status": {
                                            "type": "integer"
                                          },
                                          "get-all-agents": {
                                            "type": "integer"
                                          },
                                          "get-groups-integrity": {
                                            "type": "integer"
                                          },
                                          "insert-agent": {
                                            "type": "integer"
                                          },
                                          "reset-agents-connection": {
                                            "type": "integer"
                                          },
                                          "select-agent-group": {
                                            "type": "integer"
                                          },
                                          "select-agent-name": {
                                            "type": "integer"
                                          },
                                          "set-agent-groups": {
                                            "type": "integer"
                                          },
                                          "sync-agent-groups-get": {
                                            "type": "integer"
                                          },
                                          "sync-agent-info-get": {
                                            "type": "integer"
                                          },
                                          "sync-agent-info-set": {
                                            "type": "integer"
                                          },
                                          "update-agent-data": {
                                            "type": "integer"
                                          },
                                          "update-agent-name": {
                                            "type": "integer"
                                          },
                                          "update-connection-status": {
                                            "type": "integer"
                                          },
                                          "update-keepalive": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "delete-agent",
                                          "disconnect-agents",
                                          "find-agent",
                                          "get-agent-info",
                                          "get-agents-by-connection-status",
                                          "get-all-agents",
                                          "get-groups-integrity",
                                          "insert-agent",
                                          "reset-agents-connection",
                                          "select-agent-group",
                                          "select-agent-name",
                                          "set-agent-groups",
                                          "sync-agent-groups-get",
                                          "sync-agent-info-get",
                                          "sync-agent-info-set",
                                          "update-agent-data",
                                          "update-agent-name",
                                          "update-connection-status",
                                          "update-keepalive"
                                        ]
                                      },
                                      "belongs": {
                                        "type": "object",
                                        "properties": {
                                          "get-group-agents": {
                                            "type": "integer"
                                          },
                                          "select-group-belong": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "get-group-agents",
                                          "select-group-belong"
                                        ]
                                      },
                                      "group": {
                                        "type": "object",
                                        "properties": {
                                          "delete-group": {
                                            "type": "integer"
                                          },
                                          "find-group": {
                                            "type": "integer"
                                          },
                                          "insert-agent-group": {
                                            "type": "integer"
                                          },
                                          "select-groups": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "delete-group",
                                          "find-group",
                                          "insert-agent-group",
                                          "select-groups"
                                        ]
                                      },
                                      "labels": {
                                        "type": "object",
                                        "properties": {
                                          "get-labels": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "get-labels"
                                        ]
                                      }
                                    },
                                    "required": [
                                      "agent",
                                      "belongs",
                                      "group",
                                      "labels"
                                    ]
                                  }
                                },
                                "required": [
                                  "db",
                                  "tables"
                                ]
                              },
                              "mitre": {
                                "type": "integer"
                              },
                              "mitre_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "sql": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "sql"
                                    ]
                                  }
                                },
                                "required": [
                                  "db"
                                ]
                              },
                              "task": {
                                "type": "integer"
                              },
                              "task_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "sql": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "sql"
                                    ]
                                  },
                                  "tables": {
                                    "type": "object",
                                    "properties": {
                                      "tasks": {
                                        "type": "object",
                                        "properties": {
                                          "delete_old": {
                                            "type": "integer"
                                          },
                                          "set_timeout": {
                                            "type": "integer"
                                          },
                                          "upgrade": {
                                            "type": "integer"
                                          },
                                          "upgrade_cancel_tasks": {
                                            "type": "integer"
                                          },
                                          "upgrade_custom": {
                                            "type": "integer"
                                          },
                                          "upgrade_get_status": {
                                            "type": "integer"
                                          },
                                          "upgrade_result": {
                                            "type": "integer"
                                          },
                                          "upgrade_update_status": {
                                            "type": "integer"
                                          }
                                        },
                                        "required": [
                                          "delete_old",
                                          "set_timeout",
                                          "upgrade",
                                          "upgrade_cancel_tasks",
                                          "upgrade_custom",
                                          "upgrade_get_status",
                                          "upgrade_result",
                                          "upgrade_update_status"
                                        ]
                                      }
                                    },
                                    "required": [
                                      "tasks"
                                    ]
                                  }
                                },
                                "required": [
                                  "db",
                                  "tables"
                                ]
                              },
                              "wazuhdb": {
                                "type": "integer"
                              },
                              "wazuhdb_breakdown": {
                                "type": "object",
                                "properties": {
                                  "db": {
                                    "type": "object",
                                    "properties": {
                                      "remove": {
                                        "type": "integer"
                                      }
                                    },
                                    "required": [
                                      "remove"
                                    ]
                                  }
                                },
                                "required": [
                                  "db"
                                ]
                              }
                            },
                            "required": [
                              "agent",
                              "agent_breakdown",
                              "global",
                              "global_breakdown",
                              "mitre",
                              "mitre_breakdown",
                              "task",
                              "task_breakdown",
                              "wazuhdb",
                              "wazuhdb_breakdown"
                            ]
                          }
                        },
                        "required": [
                          "execution",
                          "execution_breakdown"
                        ]
                      }
                    },
                    "required": [
                      "queries",
                      "time"
                    ]
                  }
                },
                "required": [
                  "uptime",
                  "timestamp",
                  "name",
                  "metrics"
                ]
              }
            ]
          },
          "total_affected_items": {
            "type": "integer"
          },
          "total_failed_items": {
            "type": "integer"
          },
          "failed_items": {
            "type": "array",
            "items": {}
          }
        },
        "required": [
          "affected_items",
          "total_affected_items",
          "total_failed_items",
          "failed_items"
        ]
      },
      "message": {
        "type": "string"
      },
      "error": {
        "type": "integer"
      }
    },
    "required": [
      "data",
      "message",
      "error"
    ]
  }
