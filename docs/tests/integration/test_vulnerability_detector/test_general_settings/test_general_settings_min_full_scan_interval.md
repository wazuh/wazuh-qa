# Test general settings min full scan interval

The tests will modify the value of `min_full_scan_interval` tag in the configuration file, 
set different intervals and check the result in the logs file.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 4 | 6m27s | test_general_settings_min_full_scan_interval.py |

## Test logic

For different time units:

```
['s','m','h','d']
```

and the time value:

```
[120]
```

The test will check in the logs file if the following message appears:

```
<vulnerability_detector_prefix> A full scan will be run on agent...
```

To do so, a simulated agent is added to the system, as soon as it is detected, the Vulnerability Detector
will launch an initial scan (`BASELINE` scan) on it. Then the system date is changed to a time after
the date of the initial baseline scan, but before the minimum period set in `min_full_scan_interval`,
so that the full scan should not be triggered. Finally, the date is changed again to a time when
the period set in `min_full_scan_interval` has expired, at which point the full scan should be triggered.

## Checks

- [x] Vulnerability Detector does not start a full scan of the agent even if the CVEs database is 
  updated until the time set in `min_full_scan_interval` has expired.

## Code documentation

::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_min_full_scan_interval
