# Test general settings enabled

The tests will modify the value of `enabled` tag in `ossec.conf` and check the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 2 | 3.89s | [test_general_settings_enabled.py](../../test_general_settings/test_general_settings_enabled.py)|

## Test logic

If `enabled` is set to `yes` then, the test will check the following pattern in `ossec.log`:

```
(.*)wazuh-modulesd:vulnerability-detector(.*)
```

and not

```
(.*)DEBUG: Module disabled. Exiting...(.*)
```

If `enabled` is set to `no` then, the test will check the following pattern in `ossec.log`:

```
(.*)DEBUG: Module disabled. Exiting...(.*)
```

## Checks

- [x] Vulnerability Detector starts when `enabled` is set to `yes`.
- [x] Vulnerability Detector does not start when `enabled` is set to `no`.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 4 items

test_vulnerability_detector/test_general_settings/test_general_settings_enabled.py .ss.          [100%]

===================================== 2 passed, 2 skipped in 3.89s =====================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_enabled
