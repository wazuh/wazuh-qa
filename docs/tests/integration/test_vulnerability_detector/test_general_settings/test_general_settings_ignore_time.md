# Test general settings ignore time

The tests will modify the value of `ignore_time` tag in `ossec.conf`, set different times and check the result in
`ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 3 | 0:02:04 | [test_general_settings_ignore_time.py](../../test_general_settings/test_general_settings_ignore_time.py)|

## Test logic

For 3 different time units:

```
[3600s, 60m, 1h]
```

The following actions are done:

- Insert a custom vulnerability and vulnerable package.
- Check the initial vulnerability alert.
- Advance the time clock before the set time and check that the alert has not been generated.
- Advance the time clock just after the set time and check that the alert has been generated.

## Checks

- [x] Vulnerabilities alerts are not generated before `ignore_time` time set.
- [x] Vulnerabilities alerts are generated after `ignore_time` time set.

## Observed behaviour

The expected behaviour is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 3 items

test_vulnerability_detector/test_general_settings/test_general_settings_ignore_time.py ...       [100%]

==================================== 3 passed in 124.68s (0:02:04) =====================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_ignore_time
