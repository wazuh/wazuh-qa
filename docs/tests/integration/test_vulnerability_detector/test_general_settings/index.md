# Overview

## Objective

The purpose of testing general settings is to check the main options for Vulnerability Detector module is working as
expected. These are the general options:

- `<enabled>`
- `<min_full_scan_interval>`
- `<interval>`
- `<run_on_start>`
- `<retry_interval>`

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 20 | 0:07:07  |

## Expected behavior

- `enabled`: If it set to `yes`, Vulnerability Detector must be started, otherwise will be stopped.
- `min_full_scan_interval`: The time during which a full scan will not be performed even if the database of vulnerabilities is updated.
- `interval`: Vulnerabilities scans should start every `<x>` specified time.
- `run_on_start`: If it set to `yes`, vulnerabilities scans and providers feeds update must start when `wazuh-modulesd`
process gets started.
- `retry_interval`:  The time to wait after a scan completes to retry the agents that had a problem to be scanned.

## Testing

### Generic tests

- **[test_general_settings_enabled](test_general_settings_enabled.md#test-general-settings-enabled)**:
Tests that modify the value of `enabled` tag in the configuration file and check the result in the logs file.

- **[test_general_settings_min_full_scan_interval](test_general_settings_min_full_scan_interval.md#test-general-settings-min-full-scan-interval)**:
Tests that modify the value of `min_full_scan_interval` tag in the configuration file, set different intervals and
checking the result in the logs file.

- **[test_general_settings_interval](test_general_settings_interval.md#test-general-settings-interval)**:
Tests that modify the value of `interval` tag in the configuration file, set different times and checking the result in
the logs file.

- **[test_general_settings_run_on_start](test_general_settings_run_on_start.md#test-general-settings-run-on-start)**:
Tests that modify the value of `run_on_start` tag in the configuration file and check the result in the logs file.

- **[test_general_settings_retry_interval](test_general_settings_retry_interval.md#test-general-settings-retry-interval)**:
Tests that modify the value of `retry_interval` tag in the configuration file and check the result in the logs file.
