# Test partial scan type

The test will check if the Vulnerability Detector module performs the `PARTIAL_SCAN` type correctly.

## General info

|Tier | Number of tests | Time spent| Test file | 
|:--:|:--:|:--:|:--:| 
| 0 | 1 | 2m40s | test_partial_scan_type.py |

## Test logic

The manager is configured to use custom feeds that include vulnerabilities associated with the test packages. 
The first package is added to the database of the simulated agent and, after enrollment of the agent, 
the vulnerability detector must launch the first scan on it, which is of `BASELINE` type.

When the `BASELINE` scan is done, we will insert a new test package and wait for the `PARTIAL_SCAN` to start.
Once the `PARTIAL_SCAN` is completed, it will check that a new vulnerability has been detected and an alert
has been generated for that vulnerability by analyzing its respective logs. It will also be checked that
no alerts have been generated for the first package that had already been previously analyzed by
the `BASELINE` scan.


## Checks

- [x] The `BASELINE` and `PARTIAL_SCAN` scan startup, checking messages in the logs file.
- [x] The NVD vulnerabilities for the test packages are detected during the scans, checking messages in the logs file.
- [x] Completion of the scans, checking messages in the logs file.
- [x] Alert is generated only for the vulnerability detected during `PARTIAL_SCAN` scanning, checking messages in the alerts file.

## Code documentation

::: tests.integration.test_vulnerability_detector.test_scan_types.test_partial_scan_type
