# Test baseline scan type

The test will check if the Vulnerability Detector module performs the `BASELINE` scan type correctly.

## General info

|Tier | Number of tests | Time spent| Test file | 
|:--:|:--:|:--:|:--:| 
| 0 | 1 | 1m45s | test_baseline_scan_type.py |

## Test logic

the manager is configured to use custom feeds that include a vulnerability associated with a test package. This package
is added to the database of the simulated agent and, after enrollment of the agent, the vulnerability detector must
launch the first scan on it, which is of BASELINE type.

When the scan is done, we verify the vulnerability has been detected and no alerts have been generated for such
vulnerability in their respective logs.

## Checks

- [x] The `BASELINE` scan startup, checking `ossec.log` message.
- [x] The NVD vulnerability for the test package is detected during the scan, checking `ossec.log` message.
- [x] Completion of baseline scan, checking `ossec.log` message.
- [x] No alert is generated for the vulnerability detected during scanning, checking `alerts.log` message.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.6.8, pytest-6.2.3, py-1.10.0, pluggy-0.13.1
rootdir: /vagrant/wazuh-qa/tests/integration, configfile: pytest.ini
plugins: metadata-1.11.0, html-3.1.1, testinfra-5.0.0
collected 1 item                                                                                       

test_vulnerability_detector/test_scan_types/test_baseline_scan_type.py .                         [100%]

==================================== 1 passed in 105.39s (0:01:45) =====================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_scan_types.test_baseline_scan_type
