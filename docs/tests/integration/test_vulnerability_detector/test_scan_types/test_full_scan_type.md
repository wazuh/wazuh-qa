# Test full scan type

The test will check if the Vulnerability Detector module performs the `FULL_SCAN` type correctly.

## General info

|Tier | Number of tests | Time spent| Test file | 
|:--:|:--:|:--:|:--:| 
| 0 | 1 | 1m28s | test_full_scan_type.py |

## Test logic

The manager is configured to use custom feeds that include vulnerabilities associated with the test packages. 
Two test packages are added to the database of the simulated agent and, after enrollment of the agent, 
the vulnerability detector must launch the first scan on it, which is of `BASELINE` type.

When the `BASELINE` scan has been performed, an additional package will be inserted, and the second package
installed on the tested agent will be updated to a non-vulnerable version, then the necessary conditions
to launch a `FULL_SCAN` scan type will be triggered.

Once the full scan is complete, we will verify that two vulnerabilities remain in the `vuln_cves` table
and two alerts have been generated (one for the vulnerability detected and another for the vulnerability
removed by the update). This will be confirmed by checking the log and alert files respectively.

## Checks

- [x] The `BASELINE` and `FULLL_SCAN` scan startup, checking messages in the logs file.
- [x] The NVD vulnerabilities for the test packages are detected during the scans, checking messages in the logs file.
- [x] Completion of the scans, checking messages in the logs file.
- [x] Alerts are generated for the vulnerabilities detected during `FULL_SCAN`, checking messages in the alerts file.

## Code documentation

::: tests.integration.test_vulnerability_detector.test_scan_types.test_full_scan_type
