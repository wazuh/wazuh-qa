# Overview

## Objective

The purpose of testing general settings is to check the scan types of the Vulnerability Detector module are working as
expected. These are the general scan types:

- `BASELINE`
- `PARTIAL_SCAN`
- `FULL_SCAN`

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 3 | 0:05:53 |

## Expected behavior

- `BASELINE`: No alerts should be generated for vulnerabilities detected during this kind of scanning.
- `PARTIAL_SCAN`: Alerts should be generated only for vulnerabilities detected in new packages installed during 
  this kind of scanning.
- `FULL_SCAN`: Alerts should be generated for the newly detected vulnerabilities and the ones that no longer 
  affect the agent after the database has been updated with new information.

## Testing

### Generic tests

- **[test_baseline_scan_type](test_baseline_scan_type.md#test-baseline-scan-type)**:
  Test that launches a `BASELINE` scan on a simulated agent containing a test package. 
  It is confirmed through the logs that the vulnerability for the test package is detected 
  and no alert is generated for this vulnerability.

- **[test_partial_scan_type](test_partial_scan_type.md#test-partial-scan-type)**:
  Test that adds a simulated agent to the system with a test package containing a vulnerability then starts 
  a `BASELINE` scan and, after finishing it, adds a new test package with another vulnerability. 
  It then launches a `PARTIAL_SCAN` and checks that the alert has only been generated for the last package installed.
  
- **[test_full_scan_type](test_full_scan_type.md#test-full-scan-type)**:
  Test that adds a simulated agent to the system with two test packages containing vulnerabilities then starts 
  a `BASELINE` scan and, after finishing it, adds a new test package with another vulnerability and updates 
  the second package to a non-vulnerable version. It then launches a `FULL_SCAN` and checks that alerts 
  have been generated for both the installed package and the updated package, the latter due to the removal 
  of the vulnerability associated with it. 
  