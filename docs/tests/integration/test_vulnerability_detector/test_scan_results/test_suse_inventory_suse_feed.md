# Test SUSE inventory SUSE feed

These tests will mock SUSE systems and insert custom vulnerabilities, vulnerable packages and its related dependencies to check if Vulnerability
Detector generates the alerts from the SUSE provider feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 6 | 0:01:37 | [test_suse_inventory_suse_feed.py](../../test_scan_results/test_suse_inventory_suse_feed.py)|

## Test logic

For each SUSE system:

```
SLED15, SLES15, SLED12, SLES12, SLED11, SLES11
```

The tests will execute these actions:
- Clean NVD, `vulnerabilities`, and `sys_programs tables`.
- Mock the system.
- Insert [SUSE custom feed, vulnerable packages and dependencies](../../test_scan_results/data/suse_vulnerabilities.json).
- Import NVD vulnerabilities from [custom NVD feed](../../test_scan_results/data/real_nvd_feed.json).
- Check these events in `ossec.log`:
  ```
  The '{package}' package .* from agent .* is vulnerable to '{cve}'
  ```
  ```
  Package '{package}' not vulnerable to '{cve}'.
  ```

## Checks

- [x] A report of the corresponding vulnerabilities is generated in the `ossec.log`.
- [x] A report of non-vulnerable packages is generated in the `ossec.log`.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
================================================= test session starts ===========================================
platform linux -- Python 3.6.8, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: testinfra-6.3.0, testinfra-6.0.0, metadata-1.11.0, html-2.0.1
collected 6 items

test_vulnerability_detector/test_scan_results/test_suse_inventory_suse_feed.py ...........................[100%]

============================================= 6 passed in 97.38s (0:01:37) ======================================
```


## Code documentation

::: tests.integration.test_vulnerability_detector.test_scan_results.test_suse_inventory_suse_feed
