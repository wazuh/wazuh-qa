# Overview

## Objective

The purpose of testing providers' settings is to check if Vulnerability Detector generates alerts in the right cases.

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 35 | 0:13:54 |

## Expected behavior

After inserting custom vulnerabilities and vulnerable packages, Vulnerability Detector has to print the corresponding message in the log, generate the alerts and insert the vulnerability in the inventory. Some
considerations to take into account:

- NVD must be enabled in `ossec.conf` for scanning vulnerability alerts.
- At least one vulnerability needs to be inserted in the NVD and `vulnerabilities` tables to generate vulnerability alerts.
- The debug mode for `modulesd` mut be set in 2 in order to generate the corresponding log messages
## Testing

### Generic tests

- **[test_alas_inventory_alas_feed](test_alas_inventory_alas_feed.md#test-alas-inventory-alas-feed)**:
Tests that mock Amazon Linux systems and insert custom vulnerabilities and vulnerable packages to check if Vulnerability
Detector generates alerts from ALAS provider feed.

- **[test_alert_vulnerability_removal](test_alert_vulnerability_removal.md#test-alert-vulnerability-removal)**:
Test that adds a simulated agent to the system with two test packages containing vulnerabilities then starts
a `BASELINE` scan and, after finishing it, removes the first package and updates the second one to a non-vulnerable
version. It then launches a `PARTIAL_SCAN` and checks if alerts have been generated for these package operations.

- **[test_debian_inventory_debian_feed](test_debian_inventory_debian_feed.md#test-debian-inventory-debian-feed)**:
Tests that mock Debian systems and insert custom vulnerabilities and vulnerable packages to check if Vulnerability
Detector generates alerts from Debian provider feed.

- **[test_redhat_inventory_redhat_feed](test_redhat_inventory_redhat_feed.md#test-red-hat-inventory-red-hat-feed)**:
Tests that mock RedHat systems and insert custom vulnerabilities and vulnerable packages to check if Vulnerability
Detector generates alerts from RedHat provider feed.

- **[test_ubuntu_inventory_canonical_feed](test_ubuntu_inventory_canonical_feed.md#test-ubuntu-inventory-canonical-feed)**:
Tests that mock Ubuntu systems and insert custom vulnerabilities and vulnerable packages to see if Vulnerability Detector
generates alerts from Canonical provider feed.

- **[test_scan_nvd_feed](test_scan_nvd_feed.md#test-scan-nvd-feed)**: Tests that mock RedHat,
Ubuntu, Debian and Windows systems, and insert custom vulnerabilities and vulnerable packages to check if Vulnerability
Detector generates alerts from NVD feed.

- **[test_scan_providers_and_nvd_feed](test_scan_providers_and_nvd_feed.md#test-scan-providers-and-nvd-feed)**:
Tests that mock RedHat, Ubuntu and Debian systems, and insert custom vulnerabilities and vulnerable packages to check
if Vulnerability Detector generates alerts from NVD and providers feed.
