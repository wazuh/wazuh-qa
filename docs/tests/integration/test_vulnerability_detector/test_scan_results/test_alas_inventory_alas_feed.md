# Test Amazon Linux inventory ALAS feed

These tests will mock Amazon Linux systems and insert custom vulnerabilities and vulnerable packages to check 
if Vulnerability Detector generates the alerts from the ALAS provider feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 2 | 0:00:15 | test_alas_inventory_alas_feed.py|

## Test logic

For each Amazon Linux system:

```
Amazon-Linux, Amazon-Linux-2
```

The tests will execute these actions:
- Clean NVD, `vulnerabilities`, and `sys_programs tables`.
- Mock the system.
- Insert ALAS custom feed and vulnerable packages.
- Import NVD vulnerabilities from custom NVD feed.
- Check this event in the logs file:
  ```
  The '{package}' package .* from agent .* is vulnerable to '{cve}'
  ```

## Checks

- [x] A report of the corresponding vulnerabilities is generated in the logs file.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.6.8, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
rootdir: /vagrant/wazuh-qa/tests/integration, configfile: pytest.ini
plugins: metadata-1.11.0, html-2.0.1, testinfra-5.0.0
collected 2 items                                                                                      

test_vulnerability_detector/test_scan_results/test_alas_inventory_alas_feed.py ..                [100%]

========================================== 2 passed in 15.09s ==========================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_scan_results.test_alas_inventory_alas_feed
