# Test providers enabled

The tests will modify the value of `enabled` tag in `ossec.conf` and check the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 14 | 139.68s | [test_providers_enabled.py](../../test_providers/test_providers_enabled.py)|

## Test logic

If `enabled` is set to `yes` then, the test will check this pattern in `ossec.log`:

```
(.*)Starting '<provider_name>' database update
```

If `enabled` is set to `no` then, the test will check if this pattern does not appear in `ossec.log`:

```
(.*)Starting '<provider_name>' database update
```

## Checks

- [x] The provider's data update starts when `enabled` is set to `yes`.
- [x] The provider's data update doest does not start when `enabled` is set to `no`.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts =========================================
platform linux -- Python 3.6.8, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: testinfra-6.3.0, testinfra-6.0.0, metadata-1.11.0, html-2.0.1
collected 14 items

test_vulnerability_detector/test_providers/test_providers_enabled.py ........                   [100%]

========================================= 14 passed in 139.68s ==========================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_providers.test_providers_enabled
