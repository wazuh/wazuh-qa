# Test providers update interval

The tests will modify the value of `interval` tag in `ossec.conf`, set different time intervals and units, and check
the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 28 | 0:05:38 | [test_providers_update_interval.py](../../test_providers/test_providers_update_interval.py)|

## Test logic

The next time units are set in `<update_interval>` for each provider (Red Hat, Canonical, Debian, Arch, MSU, SUSE and NVD):

```
['60s', '60m', '1h', '1d']
```

Then, the test will do these actions:
- Check the update of os provider has not started prematurely.
- Advance the time clock just after the set time and check the provider's update has started.

## Checks

- [x] Provider os update has not started before the update interval set.
- [x] Provider os update has started just after the update interval set.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts =========================================
platform linux -- Python 3.6.8, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: testinfra-6.3.0, testinfra-6.0.0, metadata-1.11.0, html-2.0.1
collected 28 items

test_vulnerability_detector/test_providers/test_update_interval.py ................             [100%]

=================================== 28 passed in 338.05s (0:05:38) ====================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_providers.test_providers_update_interval
