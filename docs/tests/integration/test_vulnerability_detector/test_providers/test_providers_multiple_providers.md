# Test providers multiple providers

From now on, Redhat and Debian providers use two feeds to fetch vulnerabilities and CVEs metadata.
`<os path=.../>` option indicates the local path where the OVAL feed is whereas `<path.../>` indicates
the local path where the another feed is. The same goes for `<os url=.../>` and `<url.../>` options.

This test will verify if the feed configuration from multiple sources is working correctly. 

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 14 | 1m35s | test_providers_multiple_providers.py |

## Test logic

Once the configuration has been applied, check that the OVAL feed has been correctly assigned in the log file:

```
(.*)<Path|Url>: ('<OVAL feed path|url>')...
```

In the case of the RedHat provider, to verify the correct assignment of the global information feeds checks the line:

```
(.*)Multi (path|url): '<global information feed path|url>'...
```

When the feed assignment is correct, it checks that the updates for both types of feeds start:

```
(.*)Fetching feed from '<OVAL feed path|url>'...
```

```
(.*)Downloading '<global information feed path|url>'...
```

## Checks

- [x] OVAL feed assignment.
- [x] Global information feed assignment.
- [x] Starting the CVEs database update from the OVAL feed.
- [x] Starting the CVEs database update from the global information feed

## Code documentation

::: tests.integration.test_vulnerability_detector.test_providers.test_providers_multiple_providers
