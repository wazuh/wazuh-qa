# Test download feeds

These tests will check if Vulnerability Detector downloads the different feeds (Redhat, Canonical, Debian, Amazon Linux and NVD) and
imports them. It will check the confirmation message in the logs.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 1 | 16 | 0:19:49 | test_download_feeds.py |

**Timeouts**

|Red Hat | Canonical | Debian | Amazon Linux | NVD |
|:--:|:--:|:--:|:--:|:--:|
| 6m | 6m | 6m | 1m | 30m |

## Test logic

For each `provider` and `os` the feed is downloaded.

```
RedHat
Canonical: trusty, xenial, bionic and focal
Debian: wheezy, jessie, stretch, buster
NVD
ArchLinux
Amazon Linux
```

The test verifies that the download begins:

```
Starting '<system>' database update
```

and that it ends correctly:

```
The update of the '<system>' feed finished successfully
```

## Checks

- [x] Database update is started.
- [x] The update has finished successfully.

## Observed behavior

Downloading the feeds and updating the database is done correctly.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.6.8, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
rootdir: /vagrant/wazuh-qa/tests/integration, configfile: pytest.ini
plugins: metadata-1.11.0, html-2.0.1, testinfra-5.0.0
collected 16 items                                                                                     
test_vulnerability_detector/test_feeds/test_download_feeds.py .............x..                   [100%]
============================== 15 passed, 1 xfailed in 1189.10s (0:19:49) ==============================
```

## Code documentation   

::: tests.integration.test_vulnerability_detector.test_feeds.test_download_feeds