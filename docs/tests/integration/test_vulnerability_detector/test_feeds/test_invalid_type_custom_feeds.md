# Test invalid type custom feeds

Tests to check the behavior of Vulnerability Detector when importing files of different types (`.mp3`, `.jpg`,
`.pdf`...) as custom feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 106 | 0:05:00 | [test_invalid_type_custom_feeds.py](../../../test_feeds/test_invalid_type_custom_feeds.py)|

## Test logic

For each of the following extensions:

```
['', '.avi', '.doc', '.jpg', '.json', '.xml', '.mp3', '.pdf', '.zip']
```

A file with that extension is downloaded and inserted as a custom feed in the set of providers:

```
[Redhat, Canonical, Debian, NVD, Arch Linux, SUSE Linux]
```

Finally, a correct feed is added to check if it is imported successfully.

## Checks

- [x] A correct feed is imported successfully.
- [x] A no feed file with an invalid extension is detected and not imported.

## Observed behavior

In general, Vulnerability Detector realizes that it is an invalid file and discards it,
**except while importing a custom feed for NVD**. In this case, it says the feed is correctly imported when it isn't.

**Comments**

Marked as **expected fail** when importing custom files as `NVD` feeds due to if you insert any file as "feed" in
NVD provider `<path>` parameter, vulnerability detector shows logs saying that they are being imported as
feeds, although these are not. Related issue https://github.com/wazuh/wazuh/issues/5210

> Note: **expected fail** means that you expect a test to fail for some reason. A common example is a test for a feature
not yet implemented, or a bug not yet fixed.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.6.8, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: testinfra-6.3.0, testinfra-6.0.0, metadata-1.11.0, html-2.0.1
collected 106 items

test_vulnerability_detector/test_feeds/test_invalid_type_custom_feeds.py ........................... [100%]

====================================== 94 passed, 12 xfailed in 300.66s  ===============================
```

## Code documentation   

::: tests.integration.test_vulnerability_detector.test_feeds.test_invalid_type_custom_feeds