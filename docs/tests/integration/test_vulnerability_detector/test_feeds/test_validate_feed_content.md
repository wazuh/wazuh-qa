# Test validate feed content

The tests will download the feeds for all the providers and verify if the format of each feed is the expected and if
their content is a valid XML or JSON that can be parsed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 41 | 0:10:41 | [test_validate_feed_content.py](../../../test_feeds/test_validate_feed_content.py)|

## Test logic

First, all these feeds are downloaded:

- `Red Hat`: page 1 from Red Hat feed.
- `Canonical`: focal, bionic, xenial, trusty.
- `Debian`: buster, stretch, jessie, wheezy.
- `NVD`: from 2002 to current year feed.
- `Arch`: unique JSON file.
- `SUSE`: SLED 11, SLES 11, SLED 12, SLES 12, SLED 15, SLES 15.

Next, each feed's format is checked and is parseable by `XML` or `JSON`.

## Checks

- [x] Feeds have the expected extension.
- [x] Feeds are parseable `JSON` or `XML`.

## Observed behavior

Feeds are correctly validated.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.6.8, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: testinfra-6.3.0, testinfra-6.0.0, metadata-1.11.0, html-2.0.1
collected 41 items

test_vulnerability_detector/test_feeds/test_validate_feed_content.py ........................... [100%]

==================================== 41 passed in 641.04s (0:10:41) ====================================
```

## Code documentation   


::: tests.integration.test_vulnerability_detector.test_feeds.test_validate_feed_content