# Test download feeds

These tests will check if Vulnerability Detector downloads the different feeds (Redhat, Canonical, Debian and NVD) and
imports them. It will check the confirmation message in the logs.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 1 | 20 | 0:23:41 | [test_download_feeds.py](../../../test_feeds/test_download_feeds.py)|

**Timeouts**

|Red Hat | Canonical | Debian | SUSE | NVD |
|:--:|:--:|:--:|:--:|:--:|
| 6m | 6m | 6m | 6m | 30m |

## Test logic

For each `provider` and `os` the feed is downloaded.

```
RedHat
Canonical: trusty, xenial, bionic and focal
Debian: wheezy, jessie, stretch, buster
NVD
ArchLinux
SUSE Linux
```

The test verifies that the download begins:

```
Starting '<system>' database update
```

and that it ends correctly:

```
The update of the '<system>' feed finished successfully
```

## Checks

- [x] Database update is started.
- [x] The update has finished successfully.

## Observed behavior

Downloading the feeds and updating the database is done correctly.

## Execution result

```
==================================== test session starts ==============================================
platform linux -- Python 3.6.8, pytest-6.2.4, py-1.10.0, pluggy-0.13.1
rootdir: /wazuh-qa/tests/integration, configfile: pytest.ini
plugins: testinfra-6.3.0, testinfra-6.0.0, metadata-1.11.0, html-2.0.1
collected 20 items

test_vulnerability_detector/test_feeds/test_download_feeds.py ..........                         [100%]

=========================== 19 passed, 1 xfailed in 1421.45s (0:23:41) ================================
```

## Code documentation   

::: tests.integration.test_vulnerability_detector.test_feeds.test_download_feeds