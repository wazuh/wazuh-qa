# Test general settings

## Objective

The purpose of testing general settings is to check the main options for Vulnerability Detector module is working as
expected. These are the general options:

- `<enabled>`
- `<ignore_time>`
- `<interval>`
- `<run_on_start>`

## General info

|Tier | Number of tests | Time spent |
|:--:|:--:|:--:|
| 0 | 19 | 0:02:47  |

## Expected behavior

- `enabled`: If it set to `yes`, Vulnerability Detector must be started, otherwise will be stopped.
- `ignore_time`: Alerts for the same vulnerabilities should occur every `<x>` time specified and not before.
- `interval`: Vulnerabilities scans should start every `<x>` specified time.
- `run_on_start`: If it set to `yes`, vulnerabilities scans and providers feeds update must start when `wazuh-modulesd`
process gets started.

## Testing

### Generic tests

- **[test_general_settings_enabled](../doc/test_general_settings/test_general_settings_enabled.md#test-general-settings-enabled)**:
Tests that modify the value of `enabled` tag in `ossec.conf` and check the result in `ossec.log`.

- **[test_general_settings_ignore_time](../doc/test_general_settings/test_general_settings_ignore_time.md#test-general-settings-ignore-time)**:
Tests that modify the value of `ignore_time` tag in `ossec.conf`, set different times and checking the result in
`ossec.log`.

- **[test_general_settings_interval](../doc/test_general_settings/test_general_settings_interval.md#test-general-settings-interval)**:
Tests that modify the value of `interval` tag in `ossec.conf`, set different times and checking the result in
`ossec.log`.

- **[test_general_settings_run_on_start](../doc/test_general_settings/test_general_settings_run_on_start.md#test-general-settings-run-on-start)**:
Tests that modify the value of `run_on_start` tag in `ossec.conf` and check the result in `ossec.log`.



::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_run_on_start
::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_interval
::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_ignore_time
::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_enabled