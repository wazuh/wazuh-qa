from wazuh_testing.end_to_end import Check
from wazuh_testing.end_to_end.check_validators import empty, no_errors, equals


### Initial Scan Checks
all_agents_scanned_syscollector_first_scan_check = Check(
    "all_agents_scanned_syscollector_first_scan", empty,
    expected_evidences=["agents_not_scanned_syscollector_first_scan"],
)
all_agents_scanned_vulnerability_first_scan_check = Check(
    "all_agents_scanned_vulnerability_first_scan",
    empty,
    expected_evidences=["agents_not_scanned_vulnerability_first_scan"],
)
initial_vulnerabilities_consistent = Check(
    "initial_vulnerabilities_consistent",
    equals,
    expected_evidences=[
        "vd_disabled_when_agents_registration",
        "vd_enabled_when_agents_registration",
    ],
)

vulnerabilities_consistent_first_second_scan = Check(
    "vulnerabilities_consistent_first_second_scan",
    equals,
    expected_evidences=[
        "vulnerabilities_index_first_scan",
        "vulnerabilities_index_second_scan",
    ],
)

all_agents_scanned_syscollector_second_scan_check = Check(
    "all_agents_scanned_syscollector_second_scan",
    empty,
    expected_evidences=["agents_not_scanned_syscollector_second_scan"],
)


# Generic Checks
no_errors_check = Check(
    "no_errors", no_errors, expected_evidences=["error_level_messages"]
)
