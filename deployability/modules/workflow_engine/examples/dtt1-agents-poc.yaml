# Copyright (C) 2015, Wazuh Inc.
# Created by Wazuh, Inc. <info@wazuh.com>.
# This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2
version: 0.1
description: This workflow is used to test agents deployment por DDT1 PoC
variables:
  #agents-os:
  #  - linux-ubuntu-22.04-amd64
  manager-os: 
    - linux-ubuntu-22.04-amd64
    - linux-centos-7-amd64
  infra-provider: vagrant
  working-dir: /tmp/dtt1-poc

tasks:
  # Generic agent test task
  - task: "run-agent-tests"
    description: "Run tests install for the manager."
    do:
      this: process
      with:
        path: python3
        args:
          - modules/testing/main.py
          - targets:
            - wazuh-1: "{working-dir}/manager-linux-ubuntu-22.04-amd64/inventory.yaml"
            - wazuh-2: "{working-dir}/manager-linux-centos-7-amd64/inventory.yaml"
          - dependencies:
            - wazuh-1: "{working-dir}/manager-linux-ubuntu-22.04-amd64/inventory.yaml"
          - tests: "install,stop,restart,uninstall"
          - component: "manager"
          - wazuh-version: "4.7.3"
          - wazuh-revision: "1"



