[36m[2024-05-16 00:49:24] [DEBUG] [90938] [MainThread] [workflow_engine]: Validating input file: modules/workflow_engine/examples/manager/vagrant/dtt1-managers-poc-vagrant.yaml[0m
[36m[2024-05-16 00:49:24] [DEBUG] [90938] [MainThread] [workflow_engine]: Loading schema file: /home/fcaffieri/repos/wazuh-qa/.venv/lib/python3.10/site-packages/workflow_engine/schemas/schema_v1.json[0m
[36m[2024-05-16 00:49:24] [DEBUG] [90938] [MainThread] [workflow_engine]: Loading yaml file: modules/workflow_engine/examples/manager/vagrant/dtt1-managers-poc-vagrant.yaml[0m
[36m[2024-05-16 00:49:24] [DEBUG] [90938] [MainThread] [workflow_engine]: Loading workflow file: modules/workflow_engine/examples/manager/vagrant/dtt1-managers-poc-vagrant.yaml[0m
[36m[2024-05-16 00:49:24] [DEBUG] [90938] [MainThread] [workflow_engine]: Process workflow.[0m
[32m[2024-05-16 00:49:24] [INFO] [90938] [MainThread] [workflow_engine]: Executing DAG tasks.[0m
[32m[2024-05-16 00:49:24] [INFO] [90938] [MainThread] [workflow_engine]: Executing tasks in parallel.[0m
[32m[2024-05-16 00:49:24] [INFO] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: [allocate-manager-linux-centos-7-amd64] Starting task.[0m
[36m[2024-05-16 00:49:24] [DEBUG] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: Running task "allocate-manager-linux-centos-7-amd64" with arguments: ['modules/allocation/main.py', '--action=create', '--provider=vagrant', '--size=large', '--composite-name=linux-centos-7-amd64', '--instance-name=linux-centos-7-amd64', '--inventory-output=/tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml', '--track-output=/tmp/dtt1-poc/manager-linux-centos-7-amd64/track.yaml', '--label-termination-date=1d', '--label-team=qa'][0m
[32m[2024-05-16 00:49:24] [INFO] [90938] [ThreadPoolExecutor-0_1] [workflow_engine]: [allocate-manager-linux-centos-8-amd64] Starting task.[0m
[36m[2024-05-16 00:49:24] [DEBUG] [90938] [ThreadPoolExecutor-0_1] [workflow_engine]: Running task "allocate-manager-linux-centos-8-amd64" with arguments: ['modules/allocation/main.py', '--action=create', '--provider=vagrant', '--size=large', '--composite-name=linux-centos-8-amd64', '--instance-name=linux-centos-8-amd64', '--inventory-output=/tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml', '--track-output=/tmp/dtt1-poc/manager-linux-centos-8-amd64/track.yaml', '--label-termination-date=1d', '--label-team=qa'][0m
[36m[2024-05-16 00:50:38] [DEBUG] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: Finished task "allocate-manager-linux-centos-7-amd64" execution with result:
[37m[2024-05-16 00:49:25] [DEBUG] SPNEGO._GSS: Python gssapi not available, cannot use any GSSAPIProxy protocols: No module named 'gssapi'[0m
[37m[2024-05-16 00:49:25] [DEBUG] SPNEGO._GSS: Python gssapi IOV extension not available: No module named 'gssapi'[0m
[32m[2024-05-16 00:49:25] [INFO] ALLOCATOR: Creating instance at /tmp/wazuh-qa[0m
[37m[2024-05-16 00:49:26] [DEBUG] ALLOCATOR: No config provided. Generating from payload[0m
[37m[2024-05-16 00:49:26] [DEBUG] ALLOCATOR: Generating new key pair[0m
[37m[2024-05-16 00:49:30] [DEBUG] ALLOCATOR: Vagrantfile created. Creating instance.[0m
[32m[2024-05-16 00:49:30] [INFO] ALLOCATOR: Instance linux-centos-7-amd64-195 created.[0m
[32m[2024-05-16 00:50:21] [INFO] ALLOCATOR: Instance linux-centos-7-amd64-195 started.[0m
[32m[2024-05-16 00:50:30] [INFO] ALLOCATOR: Inventory file generated at /tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml[0m
[32m[2024-05-16 00:50:30] [INFO] ALLOCATOR: SSH connection successful.[0m
[32m[2024-05-16 00:50:38] [INFO] ALLOCATOR: Track file generated at /tmp/dtt1-poc/manager-linux-centos-7-amd64/track.yaml[0m
[0m
[32m[2024-05-16 00:50:38] [INFO] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: [allocate-manager-linux-centos-7-amd64] Finished task in 74.08 seconds.[0m
[36m[2024-05-16 00:50:53] [DEBUG] [90938] [ThreadPoolExecutor-0_1] [workflow_engine]: Finished task "allocate-manager-linux-centos-8-amd64" execution with result:
[37m[2024-05-16 00:49:25] [DEBUG] SPNEGO._GSS: Python gssapi not available, cannot use any GSSAPIProxy protocols: No module named 'gssapi'[0m
[37m[2024-05-16 00:49:25] [DEBUG] SPNEGO._GSS: Python gssapi IOV extension not available: No module named 'gssapi'[0m
[32m[2024-05-16 00:49:25] [INFO] ALLOCATOR: Creating instance at /tmp/wazuh-qa[0m
[37m[2024-05-16 00:49:26] [DEBUG] ALLOCATOR: No config provided. Generating from payload[0m
[37m[2024-05-16 00:49:26] [DEBUG] ALLOCATOR: Generating new key pair[0m
[37m[2024-05-16 00:49:30] [DEBUG] ALLOCATOR: Vagrantfile created. Creating instance.[0m
[32m[2024-05-16 00:49:30] [INFO] ALLOCATOR: Instance linux-centos-8-amd64-5503 created.[0m
[32m[2024-05-16 00:50:38] [INFO] ALLOCATOR: Instance linux-centos-8-amd64-5503 started.[0m
[32m[2024-05-16 00:50:45] [INFO] ALLOCATOR: Inventory file generated at /tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml[0m
[32m[2024-05-16 00:50:45] [INFO] ALLOCATOR: SSH connection successful.[0m
[32m[2024-05-16 00:50:53] [INFO] ALLOCATOR: Track file generated at /tmp/dtt1-poc/manager-linux-centos-8-amd64/track.yaml[0m
[0m
[32m[2024-05-16 00:50:53] [INFO] [90938] [ThreadPoolExecutor-0_1] [workflow_engine]: [allocate-manager-linux-centos-8-amd64] Finished task in 88.46 seconds.[0m
[32m[2024-05-16 00:50:53] [INFO] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: [run-manager-tests] Starting task.[0m
[36m[2024-05-16 00:50:53] [DEBUG] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: Running task "run-manager-tests" with arguments: ['modules/testing/main.py', "--targets={'wazuh-1': '/tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml'}", "--targets={'wazuh-2': '/tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml'}", '--tests=install', '--component=manager', '--wazuh-version=4.7.4', '--wazuh-revision=40717'][0m
[36m[2024-05-16 01:00:45] [DEBUG] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: Finished task "run-manager-tests" execution with result:
[37m[2024-05-16 00:50:54] [DEBUG] SPNEGO._GSS: Python gssapi not available, cannot use any GSSAPIProxy protocols: No module named 'gssapi'[0m
[37m[2024-05-16 00:50:54] [DEBUG] SPNEGO._GSS: Python gssapi IOV extension not available: No module named 'gssapi'[0m
[32m[2024-05-16 00:50:54] [INFO] TESTER: Running tests for 192.168.57.58[0m
[32m[2024-05-16 00:50:54] [INFO] TESTER: Running tests for 192.168.57.113[0m
[37m[2024-05-16 00:50:54] [DEBUG] TESTER: Using extra vars: {'component': 'manager', 'wazuh_version': '4.7.4', 'wazuh_revision': '40717', 'wazuh_branch': None, 'working_dir': '/tmp/tests', 'live': True, 'hosts_ip': ['192.168.57.58', '192.168.57.113'], 'targets': '{wazuh-1: /tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml, wazuh-2: /tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml}', 'dependencies': '{}', 'local_host_path': '/home/fcaffieri/repos/wazuh-qa/deployability', 'current_user': 'fcaffieri'}[0m
[37m[2024-05-16 00:50:54] [DEBUG] TESTER: Rendering template /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/playbooks/setup.yml[0m
[37m[2024-05-16 00:50:54] [DEBUG] TESTER: Using inventory: {'all': {'hosts': {'192.168.57.58': {'ansible_port': 22, 'ansible_user': 'vagrant', 'ansible_ssh_private_key_file': '/tmp/wazuh-qa/linux-centos-7-amd64-195/instance_key'}}}}[0m
[37m[2024-05-16 00:50:54] [DEBUG] TESTER: Running playbook: [{'hosts': 'localhost', 'become': True, 'become_user': 'fcaffieri', 'tasks': [{'name': 'Cleaning old key ssh-keygen registries', 'ansible.builtin.command': {'cmd': "ssh-keygen -f /home/fcaffieri/.ssh/known_hosts -R ''"}, 'loop': ['192.168.57.58', '192.168.57.113']}]}][0m
[0;34mUsing /etc/ansible/ansible.cfg as config file[0m

PLAY [localhost] ***************************************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [localhost][0m

TASK [Cleaning old key ssh-keygen registries] **********************************
[0;33mchanged: [localhost] => (item=192.168.57.58) => changed=true [0m
[0;33m  ansible_loop_var: item[0m
[0;33m  cmd:[0m
[0;33m  - ssh-keygen[0m
[0;33m  - -f[0m
[0;33m  - /home/fcaffieri/.ssh/known_hosts[0m
[0;33m  - -R[0m
[0;33m  - ''[0m
[0;33m  delta: '0:00:00.019959'[0m
[0;33m  end: '2024-05-16 00:51:00.103521'[0m
[0;33m  item: 192.168.57.58[0m
[0;33m  msg: ''[0m
[0;33m  rc: 0[0m
[0;33m  start: '2024-05-16 00:51:00.083562'[0m
[0;33m  stderr: Host  not found in /home/fcaffieri/.ssh/known_hosts[0m
[0;33m  stderr_lines: <omitted>[0m
[0;33m  stdout: ''[0m
[0;33m  stdout_lines: <omitted>[0m
[0;33mchanged: [localhost] => (item=192.168.57.113) => changed=true [0m
[0;33m  ansible_loop_var: item[0m
[0;33m  cmd:[0m
[0;33m  - ssh-keygen[0m
[0;33m  - -f[0m
[0;33m  - /home/fcaffieri/.ssh/known_hosts[0m
[0;33m  - -R[0m
[0;33m  - ''[0m
[0;33m  delta: '0:00:00.008028'[0m
[0;33m  end: '2024-05-16 00:51:00.446146'[0m
[0;33m  item: 192.168.57.113[0m
[0;33m  msg: ''[0m
[0;33m  rc: 0[0m
[0;33m  start: '2024-05-16 00:51:00.438118'[0m
[0;33m  stderr: Host  not found in /home/fcaffieri/.ssh/known_hosts[0m
[0;33m  stderr_lines: <omitted>[0m
[0;33m  stdout: ''[0m
[0;33m  stdout_lines: <omitted>[0m

PLAY RECAP *********************************************************************
[0;33mlocalhost[0m                  : [0;32mok=2   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[37m[2024-05-16 00:51:00] [DEBUG] TESTER: Playbook [{'hosts': 'localhost', 'become': True, 'become_user': 'fcaffieri', 'tasks': [{'name': 'Cleaning old key ssh-keygen registries', 'ansible.builtin.command': {'cmd': "ssh-keygen -f /home/fcaffieri/.ssh/known_hosts -R ''"}, 'loop': ['192.168.57.58', '192.168.57.113']}]}] finished with status {'skipped': {}, 'ok': {'localhost': 2}, 'dark': {}, 'failures': {}, 'ignored': {}, 'rescued': {}, 'processed': {'localhost': 1}, 'changed': {'localhost': 1}}[0m
[37m[2024-05-16 00:51:00] [DEBUG] TESTER: Rendering template /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/playbooks/test.yml[0m
[37m[2024-05-16 00:51:00] [DEBUG] TESTER: Using inventory: {'all': {'hosts': {'192.168.57.58': {'ansible_port': 22, 'ansible_user': 'vagrant', 'ansible_ssh_private_key_file': '/tmp/wazuh-qa/linux-centos-7-amd64-195/instance_key'}}}}[0m
[37m[2024-05-16 00:51:00] [DEBUG] TESTER: Running playbook: [{'hosts': 'localhost', 'become': True, 'become_user': 'fcaffieri', 'tasks': [{'name': 'Test install for manager', 'command': "python3 -m pytest modules/testing/tests/test_manager/test_install.py  -v --wazuh_version=4.7.4 --wazuh_revision=40717  --component=manager --dependencies='{}' --targets='{wazuh-1: /tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml, wazuh-2: /tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml}' --live=True -s", 'args': {'chdir': '/home/fcaffieri/repos/wazuh-qa/deployability'}}]}][0m
[0;34mUsing /etc/ansible/ansible.cfg as config file[0m

PLAY [localhost] ***************************************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [localhost][0m

TASK [Test install for manager] ************************************************
[0;33mchanged: [localhost] => changed=true [0m
[0;33m  cmd:[0m
[0;33m  - python3[0m
[0;33m  - -m[0m
[0;33m  - pytest[0m
[0;33m  - modules/testing/tests/test_manager/test_install.py[0m
[0;33m  - -v[0m
[0;33m  - --wazuh_version=4.7.4[0m
[0;33m  - --wazuh_revision=40717[0m
[0;33m  - --component=manager[0m
[0;33m  - --dependencies={}[0m
[0;33m  - '--targets={wazuh-1: /tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml, wazuh-2: /tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml}'[0m
[0;33m  - --live=True[0m
[0;33m  - -s[0m
[0;33m  delta: '0:09:29.449453'[0m
[0;33m  end: '2024-05-16 01:00:34.724341'[0m
[0;33m  msg: ''[0m
[0;33m  rc: 0[0m
[0;33m  start: '2024-05-16 00:51:05.274888'[0m
[0;33m  stderr: |-[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Removed /etc/systemd/system/multi-user.target.wants/firewalld.service.[0m
[0;33m    Removed /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.58' (ECDSA) to the list of known hosts.[0m
[0;33m    Warning: Permanently added '192.168.57.113' (RSA) to the list of known hosts.[0m
[0;33m  stderr_lines: <omitted>[0m
[0;33m  stdout: |-[0m
[0;33m    [37m[2024-05-16 00:51:06] [DEBUG] SPNEGO._GSS: Python gssapi not available, cannot use any GSSAPIProxy protocols: No module named 'gssapi'[0m[0m
[0;33m    [37m[2024-05-16 00:51:06] [DEBUG] SPNEGO._GSS: Python gssapi IOV extension not available: No module named 'gssapi'[0m[0m
[0;33m    ============================= test session starts ==============================[0m
[0;33m    platform linux -- Python 3.10.14, pytest-7.4.4, pluggy-1.4.0 -- /home/fcaffieri/repos/wazuh-qa/.venv/bin/python3[0m
[0;33m    cachedir: .pytest_cache[0m
[0;33m    rootdir: /home/fcaffieri/repos/wazuh-qa/deployability/modules[0m
[0;33m    collecting ... collected 5 items[0m
[0;33m  [0m
[0;33m    modules/testing/tests/test_manager/test_install.py::test_installation [32m[2024-05-16 00:51:06] [INFO] TESTER: Checking connection to centos-7[0m[0m
[0;33m    [32m[2024-05-16 00:51:07] [INFO] TESTER: Connection established successfully in centos-7[0m[0m
[0;33m    [32m[2024-05-16 00:51:08] [INFO] TESTER: No Firewall to disable on centos-7[0m[0m
[0;33m    [32m[2024-05-16 00:51:08] [INFO] TESTER: Checking connection to centos-8[0m[0m
[0;33m    [32m[2024-05-16 00:51:09] [INFO] TESTER: Connection established successfully in centos-8[0m[0m
[0;33m    [32m[2024-05-16 00:51:11] [INFO] TESTER: Firewall disabled on centos-8[0m[0m
[0;33m    [32m[2024-05-16 00:52:10] [INFO] TESTER: File permissions modified to be handled[0m[0m
[0;33m    [32m[2024-05-16 00:52:11] [INFO] TESTER: File copied from centos-7 (192.168.57.58) to /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/wazuh-install-files.tar[0m[0m
[0;33m    [32m[2024-05-16 00:52:12] [INFO] TESTER: Sending file from /home/vagrant/wazuh-install-files.tar to centos-8 (192.168.57.113)[0m[0m
[0;33m    [32m[2024-05-16 00:52:13] [INFO] TESTER: File permissions were restablished[0m[0m
[0;33m    [32m[2024-05-16 00:52:13] [INFO] TESTER: The file wazuh-install-files.tar deleted in /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers[0m[0m
[0;33m    [32m[2024-05-16 00:52:14] [INFO] TESTER: Installing Manager with https://packages.wazuh.com/4.7/wazuh-install.sh[0m[0m
[0;33m    [32m[2024-05-16 00:52:14] [INFO] TESTER: Installing Manager in centos-7[0m[0m
[0;33m    [32m[2024-05-16 00:54:58] [INFO] TESTER: Installing Manager with https://packages.wazuh.com/4.7/wazuh-install.sh[0m[0m
[0;33m    [32m[2024-05-16 00:54:58] [INFO] TESTER: Installing Manager in centos-8[0m[0m
[0;33m    [32m[2024-05-16 00:58:59] [INFO] TESTER: Getting status of centos-7[0m[0m
[0;33m    [32m[2024-05-16 00:59:01] [INFO] TESTER: Getting status of centos-8[0m[0m
[0;33m    [32m[2024-05-16 00:59:34] [INFO] TESTER: Cluster configured in: centos-7[0m[0m
[0;33m    [32m[2024-05-16 01:00:03] [INFO] TESTER: Cluster configured in: centos-8[0m[0m
[0;33m    PASSED[0m
[0;33m    modules/testing/tests/test_manager/test_install.py::test_manager_status [32m[2024-05-16 01:00:06] [INFO] TESTER: Getting status of centos-7[0m[0m
[0;33m    [32m[2024-05-16 01:00:07] [INFO] TESTER: Getting status of centos-8[0m[0m
[0;33m    PASSED[0m
[0;33m    modules/testing/tests/test_manager/test_install.py::test_manager_version PASSED[0m
[0;33m    modules/testing/tests/test_manager/test_install.py::test_manager_revision PASSED[0m
[0;33m    modules/testing/tests/test_manager/test_install.py::test_manager_installed_directory PASSED[0m
[0;33m  [0m
[0;33m    =============================== warnings summary ===============================[0m
[0;33m    modules/provision/models.py:36[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/provision/models.py:36: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/[0m
[0;33m        @validator('dependencies', pre=True)[0m
[0;33m  [0m
[0;33m    modules/provision/models.py:64[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/provision/models.py:64: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/[0m
[0;33m        @validator('install', 'uninstall', pre=True)[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:59[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:59: DeprecationWarning: invalid escape sequence '\w'[0m
[0;33m        "-OutFile $env:TEMP\wazuh-agent.msi"[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:62[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:62: DeprecationWarning: invalid escape sequence '\w'[0m
[0;33m        "msiexec.exe /i $env:TEMP\wazuh-agent.msi /q "[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:112[0m
[0;33m    modules/testing/tests/helpers/agent.py:112[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:112: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<address>MANAGER_IP<\/address>/<address>{host_ip}<\/address>/g' {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:129[0m
[0;33m    modules/testing/tests/helpers/agent.py:129[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:129: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i '.bak' 's/<address>MANAGER_IP<\/address>/<address>{host_ip}<\/address>/g' {WAZUH_MACOS_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:159[0m
[0;33m    modules/testing/tests/helpers/agent.py:159[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:159: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<protocol>[^<]*<\/protocol>/<protocol>{protocol}<\/protocol>/g' {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:168[0m
[0;33m    modules/testing/tests/helpers/agent.py:168[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:168: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i '' 's/<protocol>[^<]*<\/protocol>/<protocol>{protocol}<\/protocol>/g' {WAZUH_MACOS_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:176[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:176: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"(Get-Content -Path '{WAZUH_WINDOWS_CONF}') -replace '<protocol>[^<]*<\/protocol>', '<protocol>{protocol}</protocol>' | Set-Content -Path '{WAZUH_WINDOWS_CONF}'"[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/agent.py:214[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/agent.py:214: DeprecationWarning: invalid escape sequence '\w'[0m
[0;33m        f"msiexec.exe /x $env:TEMP\wazuh-agent.msi /qn"[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/manager.py:355[0m
[0;33m    modules/testing/tests/helpers/manager.py:355[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/manager.py:355: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<node_name>node01<\/node_name>/<node_name>{node_name}<\/node_name>/' {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/manager.py:356[0m
[0;33m    modules/testing/tests/helpers/manager.py:356[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/manager.py:356: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<node_type>master<\/node_type>/<node_type>{node_type}<\/node_type>/'  {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/manager.py:357[0m
[0;33m    modules/testing/tests/helpers/manager.py:357[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/manager.py:357: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<key><\/key>/<key>{key}<\/key>/' {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/manager.py:358[0m
[0;33m    modules/testing/tests/helpers/manager.py:358[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/manager.py:358: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<node>NODE_IP<\/node>/<node>{HostInformation.get_internal_ip_from_aws_dns(master_dns)}<\/node>/' {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    modules/testing/tests/helpers/manager.py:359[0m
[0;33m    modules/testing/tests/helpers/manager.py:359[0m
[0;33m      /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/tests/helpers/manager.py:359: DeprecationWarning: invalid escape sequence '\/'[0m
[0;33m        f"sed -i 's/<disabled>yes<\/disabled>/<disabled>{disabled}<\/disabled>/' {WAZUH_CONF}",[0m
[0;33m  [0m
[0;33m    -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html[0m
[0;33m    ================== 5 passed, 24 warnings in 567.62s (0:09:27) ==================[0m
[0;33m  stdout_lines: <omitted>[0m

PLAY RECAP *********************************************************************
[0;33mlocalhost[0m                  : [0;32mok=2   [0m [0;33mchanged=1   [0m unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[37m[2024-05-16 01:00:35] [DEBUG] TESTER: Playbook [{'hosts': 'localhost', 'become': True, 'become_user': 'fcaffieri', 'tasks': [{'name': 'Test install for manager', 'command': "python3 -m pytest modules/testing/tests/test_manager/test_install.py  -v --wazuh_version=4.7.4 --wazuh_revision=40717  --component=manager --dependencies='{}' --targets='{wazuh-1: /tmp/dtt1-poc/manager-linux-centos-7-amd64/inventory.yaml, wazuh-2: /tmp/dtt1-poc/manager-linux-centos-8-amd64/inventory.yaml}' --live=True -s", 'args': {'chdir': '/home/fcaffieri/repos/wazuh-qa/deployability'}}]}] finished with status {'skipped': {}, 'ok': {'localhost': 2}, 'dark': {}, 'failures': {}, 'ignored': {}, 'rescued': {}, 'processed': {'localhost': 1}, 'changed': {'localhost': 1}}[0m
[32m[2024-05-16 01:00:35] [INFO] TESTER: Cleaning up[0m
[37m[2024-05-16 01:00:35] [DEBUG] TESTER: Using inventory: {'all': {'hosts': {'192.168.57.58': {'ansible_port': 22, 'ansible_user': 'vagrant', 'ansible_ssh_private_key_file': '/tmp/wazuh-qa/linux-centos-7-amd64-195/instance_key'}}}}[0m
[37m[2024-05-16 01:00:35] [DEBUG] TESTER: Running playbook: /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/playbooks/cleanup.yml[0m
[0;34mUsing /etc/ansible/ansible.cfg as config file[0m

PLAY [all] *********************************************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [192.168.57.58][0m

TASK [Clean test directory] ****************************************************
[0;32mok: [192.168.57.58] => changed=false [0m
[0;32m  path: /tmp/tests[0m
[0;32m  state: absent[0m

PLAY RECAP *********************************************************************
[0;32m192.168.57.58[0m              : [0;32mok=2   [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[37m[2024-05-16 01:00:40] [DEBUG] TESTER: Playbook /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/playbooks/cleanup.yml finished with status {'skipped': {}, 'ok': {'192.168.57.58': 2}, 'dark': {}, 'failures': {}, 'ignored': {}, 'rescued': {}, 'processed': {'192.168.57.58': 1}, 'changed': {}}[0m
[32m[2024-05-16 01:00:40] [INFO] TESTER: Cleaning up[0m
[37m[2024-05-16 01:00:40] [DEBUG] TESTER: Using inventory: {'all': {'hosts': {'192.168.57.58': {'ansible_port': 22, 'ansible_user': 'vagrant', 'ansible_ssh_private_key_file': '/tmp/wazuh-qa/linux-centos-7-amd64-195/instance_key'}}}}[0m
[37m[2024-05-16 01:00:40] [DEBUG] TESTER: Running playbook: /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/playbooks/cleanup.yml[0m
[0;34mUsing /etc/ansible/ansible.cfg as config file[0m

PLAY [all] *********************************************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [192.168.57.58][0m

TASK [Clean test directory] ****************************************************
[0;32mok: [192.168.57.58] => changed=false [0m
[0;32m  path: /tmp/tests[0m
[0;32m  state: absent[0m

PLAY RECAP *********************************************************************
[0;32m192.168.57.58[0m              : [0;32mok=2   [0m changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
[37m[2024-05-16 01:00:45] [DEBUG] TESTER: Playbook /home/fcaffieri/repos/wazuh-qa/deployability/modules/testing/playbooks/cleanup.yml finished with status {'skipped': {}, 'ok': {'192.168.57.58': 2}, 'dark': {}, 'failures': {}, 'ignored': {}, 'rescued': {}, 'processed': {'192.168.57.58': 1}, 'changed': {}}[0m
[0m
[32m[2024-05-16 01:00:45] [INFO] [90938] [ThreadPoolExecutor-0_0] [workflow_engine]: [run-manager-tests] Finished task in 592.55 seconds.[0m
[32m[2024-05-16 01:00:45] [INFO] [90938] [MainThread] [workflow_engine]: Executing Reverse DAG tasks.[0m
[32m[2024-05-16 01:00:45] [INFO] [90938] [MainThread] [workflow_engine]: Executing tasks in parallel.[0m
